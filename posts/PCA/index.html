<!DOCTYPE html><html lang="en" mode="light" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate"><meta http-equiv="Expires" content="0"><meta http-equiv="Pragma" content="no-cache"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="PCA(주성분 분석)" /><meta name="author" content="Gukwon Koo" /><meta property="og:locale" content="en" /><meta name="description" content="원래 데이터들을 어느 벡터에 사영시켜야 데이터의 구조를 최대한 보존할 수 있을까?" /><meta property="og:description" content="원래 데이터들을 어느 벡터에 사영시켜야 데이터의 구조를 최대한 보존할 수 있을까?" /><link rel="canonical" href="https://gguguk.github.io/posts/PCA/" /><meta property="og:url" content="https://gguguk.github.io/posts/PCA/" /><meta property="og:site_name" content="생각과 고민." /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-01-11T11:28:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="PCA(주성분 분석)" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@Gukwon Koo" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Gukwon Koo"},"dateModified":"2021-01-11T11:28:00+09:00","datePublished":"2021-01-11T11:28:00+09:00","description":"원래 데이터들을 어느 벡터에 사영시켜야 데이터의 구조를 최대한 보존할 수 있을까?","headline":"PCA(주성분 분석)","mainEntityOfPage":{"@type":"WebPage","@id":"https://gguguk.github.io/posts/PCA/"},"url":"https://gguguk.github.io/posts/PCA/"}</script><title>PCA(주성분 분석) | 생각과 고민.</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="생각과 고민."><meta name="application-name" content="생각과 고민."><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/sample/bear.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">생각과 고민.</a></div><div class="site-subtitle font-italic">주니어 데이터 사이언티스트입니다.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/gguguk" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://www.linkedin.com/in/%EA%B5%AD%EC%9B%90-%EA%B5%AC-32a9691a1/" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>PCA(주성분 분석)</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>PCA(주성분 분석)</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Gukwon Koo </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Mon, Jan 11, 2021, 11:28 AM +0900" >Jan 11, 2021<i class="unloaded">2021-01-11T11:28:00+09:00</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="4271 words">23 min read</span></div></div><div class="post-content"><p><img data-proofer-ignore data-src="https://i.imgur.com/Uv2dlsH.gif" alt="" /><em>원래 데이터들을 어느 벡터에 사영시켜야 데이터의 구조를 최대한 보존할 수 있을까?</em></p><p><br /></p><h3 id="3줄-요약">3줄 요약</h3><hr /><ul><li>PCA는 데이터의 <strong>기존 구조를 최대한 유지</strong>하고자 하는 목적을 가진 <strong>변수 추출 또는 차원 축소</strong> 기법임<li>데이터의 기존 구조를 최대한 유지 하기 위해서는 <strong>사영(projection) 하였을 때 분산이 최대가 되는 방향</strong>의 벡터를 찾아야 함<li>데이터의 <strong>공분산 행렬의 고유벡터</strong>가 분산이 최대가 되는 방향의 벡터임</ul><hr /><p><br /></p><h3 id="본-글을-이해하기-위해-필요한-개념">본 글을 이해하기 위해 필요한 개념</h3><hr /><ul><li>내적<li>사영(projection)<li>대칭 행렬<li>공분산 행렬(covariance matrix)<li>고유값과 고유벡터<li>벡터 미분<li>라그랑주 승수법</ul><hr /><p><br /></p><p>앞선 글에서 <a href="https://gguguk.github.io/posts/eigenvalue_eigenvector/">고유값과 고유벡터</a>에 대해 살펴 보았습니다. 본 글에서는 이를 활용한 대표적 변수 추출 또는 차원 축소 기법인 주성분 분석(PCA)에 관련된 내용을 정리하고자 합니다. 머신러닝을 공부해보신 분들은 한번쯤은 들어보셨을 텐데요. 매우 친숙한 알고리즘인데 반해 선형대수 기초 개념이 없으면 생각보다 이해하기 어려운 것도 사실입니다. 저와 함께 차근차근 알아가 보시죠. 본 글에서는 PCA의 개념을 살펴보고 PCA의 해를 찾는 방법, PCA의 가정과 활용 예시를 살펴보도록 하겠습니다.</p><p><br /></p><p>본 글의 행렬, 벡터, 벡터의 원소의 표기는 다음을 따릅니다.</p><ul><li>행렬: \(\boldsymbol{X}\)<li>벡터: \(\boldsymbol{x}\)<li>벡터의 원소: \(x_1, x_2, \cdots, x_i\)</ul><p><br /></p><h1 id="1-pca주성분-분석">1   PCA(주성분 분석)</h1><hr /><h2 id="개요"><strong>개요</strong></h2><p>PCA는 <strong>주어진 데이터들의 구조를 최대한 보존할 수 있는 주성분(principal component)을 찾아주는 변수 추출(feature extraction) 기법</strong>입니다. PCA는 비모수적 기법으로 분포적인 가정을 요구하지 않기 때문에 매우 다양한 분야에서 활용되고 있습니다. <strong>주성분</strong>과 <strong>변수 추출</strong>이라는 어려운 단어가 2개나 나왔네요. 먼저 이해하기 쉬운 것부터 살펴보겠습니다.</p><h3 id="변수-추출"><strong>변수 추출</strong></h3><p>변수 추출이란 데이터가 가진 변수를 조합하여 새로운 변수를 만드는 기법을 말합니다. 예를들어 수학 점수와 영어 점수로 이루어진 데이터가 있다고 해봅사다. 수학 점수와 영어 점수를 잘 조작해서 새로운 변수를 만들 수도 있겠죠. 가장 간단하게는 \(0.5 \times\)수학점수 + \(0.5 \times\)영어 점수를 통해 새로운 변수를 만들 수도 있습니다. 이를 내적의 형태로 표현하면 다음과 같이 표현할 수 있습니다.</p><p><br /></p>\[\left[ \begin{matrix} \text{수학 점수} &amp; \text{영어 점수} \end{matrix} \right] \\ \left[ \begin{matrix} 0.5 \\ \\ 0.5 \end{matrix} \right] = 0.5 \times \text{수학 점수} + 0.5 \times \text{영어 점수}\]<p><br /></p><p>그렇다면 <strong>어떤 벡터</strong>에 데이터를 내적해야 기존 변수들을 잘 종합할 수 있을지에 대한 의문이 생깁니다. PCA는 이에 대한 답을 제공합니다. 그러나 막연하게 생각하면 어려우니까 <strong>데이터의 구조 혹은 분포</strong>를 활용해보자는 아이디어에서 출발하는 것이죠. 정리하자면 PCA는 어떻게 하면 데이터를 <strong>잘 종합하는 변수를 만들 수 있을까</strong>에 대한 솔루션인 셈입니다.</p><p><br /></p><blockquote><p>한편 PCA를 차원축소 기법으로도 많이 이야기 하는데, 이는 PCA를 수행하여 찾아낸 모든 고유벡터를 활용하지 않고 일부의 고유벡터만 활용한다면 데이터의 차원을 축소 할 수 있기 때문입니다. 고유벡터와 관련된 개념은 뒤에서 더 자세히 설명하겠습니다.</p></blockquote><p><br /></p><h3 id="주성분principal-component"><strong>주성분(principal component)</strong></h3><p>다음으로 주성분입니다. <strong>주성분</strong>이란 <strong>데이터를 사영<sup id="fnref:3"><a href="#fn:3" class="footnote" rel="footnote" role="doc-noteref">1</a></sup> 시켰때 사영된 데이터들의 분산이 최대화 되는 벡터</strong>를 말합니다. 글만 보면 이해하기 어렵습니다. 아래 두 이미지를 보시죠. 두 이미지는 파란색 점으로 표현된 데이터들을 검은색 실선으로 표현된 두개의 벡터에 각각 사영시켰습니다. 사영된 데이터들을 빨간색 점으로 나타냈는데요. 사영된 데이터들의 <strong>분산이 최대</strong>가 되는 (데이터가 더 넓게 퍼져 있는) <strong>벡터</strong>는 무엇인가요?</p><p><br /></p><p><img data-proofer-ignore data-src="/assets/img/post_img/pca_variance.png" alt="" width="650" /></p><p><br /></p><p>왼쪽보다는 오른쪽 벡터가 빨간색 점들이 더 넓게 분포 되어 있음을 알 수 있습니다. 다시 말해 왼쪽 이미지는 분산이 낮고 오른쪽 이미지는 분산이 높다는 것이죠. 이렇게 기하학적으로 보았을 때 어느 쪽이 더 원래의 데이터의 형태를 잘 유지하고 있나요? 물론 두 이미지 모두 기존 데이터가 가진 정보는 일부 상실되었습니다. 그럼에도 불구하고 최대한 기존 구조를 유지하며 정보가 압축된 이미지는 어느 것인가요? 바로 오른쪽 이미지이죠.</p><p>주성분은 데이터를 사영시켰을 때 기존 구조를 최대한 잘 유지할 수 있게 하는 벡터를 뜻합니다. 데이터의 기존 구조가 최대한 잘 유지 된다는 뜻은 바로 사영 후의 분산이 최대가 되는 것이구요. 그렇다면 결국 PCA라는 알고리즘이 하고 싶은 것은 <strong>데이터를 사영 후 분산이 최대가 되도록 하는 벡터를 찾는 일로 귀결</strong>됨을 알 수 있습니다. 또한 예시는 2차원을 보여드렸지만 3차원 또는 그 이상에서도 같은 논리로 분산이 최대가 되는 벡터를 찾아 볼 수 있습니다.</p><p><br /></p><h1 id="2--pca의-가정-및-특성">2   PCA의 가정 및 특성</h1><h2 id="pca의-가정"><strong>PCA의 가정</strong></h2><p>PCA는 아래의 3가지 가정에 기반하고 있습니다. 그러나 이러한 가정이 항상 들어 맞지는 않겠죠. 데이터의 형태에 따라 PCA는 <strong>실패(fail)</strong>하기도 합니다(<a href="https://arxiv.org/pdf/1404.1100&amp;sa=U&amp;ved=2ahUKEwi57Mfr0ZDpAhWtF6YKHfSxAck4ChAWMAZ6BAgEEAE&amp;usg=AOvVaw2ccduDFnmcXvF-iGE-VXIM">Shlens, J., 2014</a>).</p><h3 id="linearity">Linearity</h3><p>사영된 데이터들은 직선 위에 존재한다고 가정합니다. 그러나 아래의 이미지처럼 데이터들이 <strong>곡선</strong>을 따라 사영되었을 때 더욱 데이터의 구조를 잘 유지할 수 있는 경우도 있습니다. 기본적인 PCA는 이러한 비선형성을 잡아내지 못합니다. 따라서 비선형성을 반영할 수 있는 <a href="http://www.nlpca.org/">non-linear PCA 기법</a>도 존재한다고 합니다.</p><p><img data-proofer-ignore data-src="https://www.researchgate.net/profile/Alberto_Bernacchia/publication/29619601/figure/fig3/AS:668906024865792@1536491032022/Two-Nonlinear-PCA-fits-Data-points-are-the-same-data-of-Fig-2-projected-along-the.png" alt="" width="600" /><em>non-linear PCA의 예시 (출처: http://www.nlpca.org/)</em></p><p><br /></p><h3 id="large-variances-have-important-structure">Large variances have important structure</h3><p>분산이 큰 방향이 데이터 구조의 중요한 정보를 가지고 있다고 가정합니다. 그러나 이러한 가정 역시 데이터의 구조에 따라 위배가 되는 경우가 있습니다. 아래의 그림은 놀이동산 관람차를 탄 사람들의 좌표값을 나타낸 그림입니다. 빨간색 축은 데이터의 분산이 가장 큰 방향의 축입니다. 그러나 기존 데이터를 종합한다는 의미로 볼때, 해당 축에 사영하는 것이 가장 좋은 선택일까요? 아래 그림에서는 오히려 관람차의 회전 각도 \(\theta\)라는 하나의 변수만 있으면 3차원 데이터를 1차원 스칼라 값으로 압축할 수 있습니다. 다시 말해 데이터를 압축하여 표현할 때 분산이 최대인 축을 선택하는 것이 능사가 아니라는 것입니다.</p><p><img data-proofer-ignore data-src="/assets/img/post_img/pca_fail_large_variance.png" alt="" width="250" /><em>“A Tutorial on Principal Component Analysis”, Jonathon Shlens</em></p><p><br /></p><h3 id="the-principal-components-are-orthogonal">The principal components are orthogonal</h3><p>주성분끼리는 항상 직교(orthogonal) 한다고 가정합니다. 이 가정 역시 모든 데이터에 항상 맞는 가정은 아닌데요. 아래의 그림을 보시면 빨간색 축이 데이터의 분산이 가장 큰 방향의 벡터입니다. 가로로 긴 첫번째 축은 데이터의 구조를 표현하기에 적절한 선택인 것 같습니다. 그러나 이 축과 직교하는 두번째 축은 non-orthogonal한 데이터의 특징을 잘 잡아내지 못합니다.</p><p><img data-proofer-ignore data-src="/assets/img/post_img/pca_fail_non_orthogonal_axes.png" alt="" width="250" /><em>“A Tutorial on Principal Component Analysis”, Jonathon Shlens</em></p><p><br /></p><h1 id="3-pca-해-찾기">3   PCA 해 찾기</h1><hr /><p>이제 직접 사영시켰을 때 분산이 최대가 되는 벡터 \(\boldsymbol{v}\)를 찾아보죠 🙌 그전에 몇 가지 가정할 사항이 있습니다.</p><ul><li>우리가 찾을 벡터 \(\boldsymbol{v}\)는 <strong>단위 벡터</strong><sup id="fnref:1"><a href="#fn:1" class="footnote" rel="footnote" role="doc-noteref">2</a></sup>입니다<li>데이터 행렬 \(\boldsymbol{X}\)는 \(n\)개의 데이터, \(d\)개의 변수(feature)를 가진 \(n \times d\) 행렬입니다.<li>데이터 행렬 \(\boldsymbol{X}\)의 각 변수들은 평균이 \(0\)으로 centering 되어있습니다. 다시 말해 데이터 행렬 \(\boldsymbol{X}\)의 \(k\)번째 열벡터 \(\boldsymbol{x}_k\)는 \(\boldsymbol{x}_k - E(\boldsymbol{x}_k)\)가 되어 있는 상태입니다.<li>앞으로 등장할 설명과 수식은 \(d\)차원의 데이터 \(\boldsymbol{X}\)를 1차원으로 차원 감소하는 상황을 가정한 예시들입니다.</ul><p><br /></p><p>\(n \times d\) 데이터 행렬은 다음과 같이 표기합니다.</p><p><br /></p>\[\boldsymbol{X} =\left[ \begin{matrix} x_{11} &amp; \cdots &amp; x_{1d} \\ \vdots &amp; \ddots &amp; \vdots \\ x_{n1} &amp; \cdots &amp; x_{nd} \end{matrix} \right] = \left[ \begin{matrix} | &amp; \cdots &amp; | \\ \boldsymbol{x}_1 &amp; \ddots &amp; \boldsymbol{x}_d \\ | &amp; \cdots &amp; | \end{matrix} \right]\]<p><br /></p><p>자, 이제 우리는 <strong>데이터 행렬 \(X\)를 어떤 벡터 \(\boldsymbol{v}\)에 사영해야 사영된 데이터들의 분산이 최대</strong>가 될지를 찾아야 합니다. 이는 <strong>데이터 행렬 \(\boldsymbol{X}\)의 행벡터들과 열벡터 \(\boldsymbol{v}\)를 내적</strong>하는 것으로 구할 수 있습니다. 사영과 내적이 어떤 관련이 있는걸까요? 우리는 앞서 벡터 \(\boldsymbol{v}\)를 단위 벡터라고 가정했습니다. 따라서 어떤 벡터의 단위 벡터에 대한 정사영 벡터는 두 벡터를 내적하는 것만으로도 도출할 수 있습니다<sup id="fnref:5"><a href="#fn:5" class="footnote" rel="footnote" role="doc-noteref">3</a></sup> 사영과 관련된 내용은 <a href="https://ratsgo.github.io/linear%20algebra/2017/10/20/projection/">이 글</a>을 추천드립니다. 행벡터와 열벡터 \(\boldsymbol{v}\)의 내적을 일일이 진행할 수 없으니 matrix notation을 통해 표현해 보죠. 참고로 \(\boldsymbol{X}\boldsymbol{v}\) 는 \(n \times 1\) 크기를 가지는 열벡터입니다.</p><p><br /></p>\[\boldsymbol{X}\boldsymbol{v} =\left[ \begin{matrix} x_{11} &amp; \cdots &amp; x_{1d} \\ \vdots &amp; \ddots &amp; \vdots \\ x_{n1} &amp; \cdots &amp; x_{nd} \end{matrix} \right] \left[ \begin{matrix} v_1 \\ \vdots \\ v_d \end{matrix} \right]\]<p><br /></p><p>데이터 \(\boldsymbol{X}\)를 어떤 단위 벡터 \(\boldsymbol{v}\)에 사영하는 것은 \(\boldsymbol{Xv}\) 를 계산하는 것과 같다는 것을 알게되었습니다. 그럼 사영된 데이터의 분산이 최대가 되는 벡터 \(\boldsymbol{v}\)를 찾는 것을 수식으로 표현해볼까요?</p><p><br /></p>\[\DeclareMathOperator*{\argmax}{argmax}\argmax_{\boldsymbol{v}}\Big[Var(\boldsymbol{X}\boldsymbol{v})\Big]\]<p><br /></p><p>이제 \(Var(\boldsymbol{X}\boldsymbol{v})\)를 전개해 나가 보겠습니다.</p><p><br /></p>\[\begin{align} Var(\boldsymbol{X}\boldsymbol{v}) \tag{1} &amp;= E[(\boldsymbol{X}\boldsymbol{v})^2] - E[(\boldsymbol{X}\boldsymbol{v})]^2 \\[1em] \tag{2} &amp;= \cfrac{1}{n} \sum_{i=1}^{n}x_i^2 - \bigg(\cfrac{1}{n}\sum_{i=1}^{n}x_i \bigg)^2 \\[1em] \tag{3} &amp;= \cfrac{1}{n} \sum_{i=1}^{n}x_i^2 \\[1em] \tag{4} &amp;= \cfrac{1}{n} (\boldsymbol{X}\boldsymbol{v})^{T} (\boldsymbol{X}\boldsymbol{v}) \\[1em] \tag{5} &amp;= \cfrac{1}{n} \boldsymbol{v}^{T}\boldsymbol{X}^{T}\boldsymbol{X}\boldsymbol{v} \\[1em] \tag{6} &amp;= \boldsymbol{v}^{T} \cfrac{\boldsymbol{X}^{T}\boldsymbol{X}}{n} \boldsymbol{v} \\[1em] \tag{7} &amp;= \boldsymbol{v}^{T} \Sigma \boldsymbol{v} \end{align}\]<p><br /></p><p>\((2)\)의 \(\bigg(\cfrac{1}{n}\sum_{i=1}^{n}x_i \bigg)^2\)은 \(0\)이 되어 사라지는 term입니다. 그 이유는 우리가 데이터 행렬 \(\boldsymbol{X}\)의 열벡터들이 모두 평균 0으로 centering 되어 있다고 가정했기 때문입니다. 직접 숫자를 대입해 계산 해보시면 쉽게 이해가 가실겁니다. 또한 \((6)\)의 \(\cfrac{\boldsymbol{X}^{T}\boldsymbol{X}}{n}\)는 <a href="https://angeloyeo.github.io/2019/07/27/PCA.html#fnref:6">공분산 행렬</a>을 나타내는데요. 이 역시도 데이터 행렬 \(\boldsymbol{X}\)의 열벡터들이 모두 평균 0으로 centering 되어 있다고 가정했기 때문입니다.</p><p><br /></p><p>목적식을 \(\boldsymbol{v}^{T} \Sigma \boldsymbol{v}\), 제약식을 \(\|\boldsymbol{v}\|= \boldsymbol{v}^T\boldsymbol{v} = 1\)으로 두고 라그랑주 승수법<sup id="fnref:4"><a href="#fn:4" class="footnote" rel="footnote" role="doc-noteref">4</a></sup>을 이용하여 다음의 보조 방정식 \(L\)을 만들 수 있습니다. 제약식은 \(\boldsymbol{v}\)를 단위벡터로 가정한 결과로 도출되었습니다.</p><p><br /></p>\[L = \boldsymbol{v}^{T} \Sigma \boldsymbol{v} - \lambda(\|\boldsymbol{v}\|-1)\]<p><br /></p><p>최대값을 구하기 위해 \(L\)을 \(\boldsymbol{v}\)에 대해 편미분한 식을 \(0\)으로 두고 전개하겠습니다. 벡터의 미분 공식은 <a href="https://darkpgmr.tistory.com/141">이 글</a>을 참고해주세요.</p><p><br /></p>\[\cfrac{\partial L}{\partial \boldsymbol{v}} = 2\Sigma\boldsymbol{v} - 2\lambda\boldsymbol{v} = 0\]<p><br /></p><p>최종적으로 아래의 식을 얻을 수 있습니다.</p><p><br /></p>\[\Sigma\boldsymbol{v} = \lambda\boldsymbol{v}\]<p><br /></p><p>어딘가 익숙한 수식 아닌가요? 어떤 벡터에 선형변환 행렬을 곱했더니 크기는 변하지만 방향이 변하지 않는 벡터가 있다는 뜻이네요. 바로 <a href="https://gguguk.github.io/posts/eigenvalue_eigenvector/">고유값과 고유벡터</a>에 관한 수식임을 알 수 있습니다.</p><p>따라서 PCA가 하는 일은 <strong>데이터 행렬 \(\boldsymbol{X}\)의 공분산 행렬 \(\Sigma\)의 고유 벡터를 찾는 것</strong>입니다. 또한 우리가 수식을 전개해와서 알 수 있듯이 <strong>그 고유 벡터가 데이터들의 사영 후 분산을 최대화 시키는 벡터</strong>입니다. 또한 우리는 고유벡터끼리의 직교성을 가정하였는데요. <a href="https://ratsgo.github.io/machine learning/2017/04/24/PCA">공분산 행렬의 고유벡터는 서로 직교하는 성질</a>이 (정확하게는 대칭행렬<sup id="fnref:6"><a href="#fn:6" class="footnote" rel="footnote" role="doc-noteref">5</a></sup>의 특성) 있기 때문에 가정에 위배 되지 않습니다.</p><p>고유벡터는 최대 데이터 행렬 \(\boldsymbol{X}\)의 차원 수인 \(d\)개 만큼 존재할 수 있습니다. 따라서 \(d\)개의 고유벡터를 활용한다면 데이터의 차원은 \(d\)차원으로 유지할 수 있으면서도 각 열벡터들의 상관 관계를 제거할 수 있는 결과를 가져다 줍니다 (공분산 행렬의 고유벡터들은 서로 orthogonal 하기 때문입니다 ). 또한 고유벡터를 \(k(\lt d)\)개 만큼만 사용한다면 \(d\)차원을 \(k\)차원으로 차원축소 할 수 있게 됩니다.</p><p><br /></p><h1 id="4-pca-활용-방법">4   PCA 활용 방법</h1><h2 id="차원-축소를-통한-시각화">차원 축소를 통한 시각화</h2><p>아래의 이미지처럼 3차원 공간에 존재하는 데이터들을 2개의 고유벡터에 사영시키면 2차원의 데이터로 차원을 축소할 수 있습니다. 따라서 고차원의 데이터를 우리가 쉽게 상상할 수 있는 2차원이나 3차원 데이터로 표현하므로써 데이터에 대한 기하학적 해석을 용이하게 할 수 있습니다.</p><p><img data-proofer-ignore data-src="/assets/img/post_img/pca_3d_to_2d.jpg" alt="" width="650" /><em>3차원 데이터를 2차원으로 축소한 예시</em></p><h2 id="선형-회귀의-데이터로-활용">선형 회귀의 데이터로 활용</h2><p>공분산 행렬의 고유 벡터들을 서로 직교(orthogonal) 하는 특성이 있습니다 (정확하게는 대칭행렬<sup id="fnref:6:1"><a href="#fn:6" class="footnote" rel="footnote" role="doc-noteref">5</a></sup>의 특성입니다). <a href="https://angeloyeo.github.io/2019/08/20/correlation_and_inner_product.html">직교하는 벡터는 상관관계가 0</a>이기 때문에 서로 다른 고유 벡터에 사영하여 얻어진 벡터들은 상관관계가 없어집니다. 다시 말해 correlation이 있는 변수들을 decorrelation 하게 변환시켜줄 수 있다는 의미이죠. 따라서 PCA를 통한 변수 추출을 통해 다중공선성 문제에서 벗어날 수 있습니다.</p><p><br /></p><h1 id="참고자료">참고자료</h1><hr /><ul><li><a href="https://angeloyeo.github.io/2019/07/27/PCA.html#fnref:6">주성분 분석(PCA), 공돌이의 수학정리노트 </a><li><a href="https://ratsgo.github.io/machine learning/2017/04/24/PCA/">주성분분석(Principal Component Analysis), ratsgo’s blog</a><li><a href="https://darkpgmr.tistory.com/110">주성분분석(PCA)의 이해와 활용, 다크 프로그래머</a><li><a href="http://blog.naver.com/PostView.nhn?blogId=sw4r&amp;logNo=221031465518&amp;parentCategoryNo=&amp;categoryNo=43&amp;viewDate=&amp;isShowPopularPosts=true&amp;from=search">PCA (Principal Component Analysis): 주성분분석에 대한 모든 것! , 통계학에 관한 모든것</a><li><a href="http://www.stat.cmu.edu/~cshalizi/350/lectures/10/lecture-10.pdf">Principal Components: Mathematics, Example, Interpretation</a><li><a href="https://blog.exploratory.io/an-introduction-to-principal-component-analysis-pca-with-2018-world-soccer-players-data-810d84a14eab">An Introduction to Principal Component Analysis (PCA) with 2018 World Soccer Players Data, Kan Nishida</a><li><a href="https://arxiv.org/pdf/1404.1100&amp;sa=U&amp;ved=2ahUKEwi57Mfr0ZDpAhWtF6YKHfSxAck4ChAWMAZ6BAgEEAE&amp;usg=AOvVaw2ccduDFnmcXvF-iGE-VXIM">Shlens, J. (2014). A tutorial on principal component analysis. <em>arXiv preprint arXiv:1404.1100</em>.</a><li><a href="https://bskyvision.com/347">고유값 분해와 뗄래야 뗄 수 없는 주성분분석, bskyvision</a><li><a href="https://en.wikipedia.org/wiki/Matrix_calculus">Matrix calculus, wikipedia</a><li><a href="https://darkpgmr.tistory.com/141">벡터 미분과 행렬 미분, 다크 프로그래머</a><li><a href="https://ratsgo.github.io/linear%20algebra/2017/10/20/projection/">사영(projection), ratsgo’s blog</a><li><a href="http://elearning.kocw.net/contents4/document/lec/2013/Chungbuk/LeeGeonmyeong1/12.pdf">대각화와 고유값 분해</a><li><a href="https://ko.wikipedia.org/wiki/%EB%9D%BC%EA%B7%B8%EB%9E%91%EC%A3%BC_%EC%8A%B9%EC%88%98%EB%B2%95">라그랑주 승수법, 위키피디아</a></ul><p><br /></p><h1 id="footnote">footnote</h1><div class="footnotes" role="doc-endnotes"><ol><li id="fn:3"><p>도형의 각 점에서 한 평면에 내린 수선의 발을 의미합니다. <a href="#fnref:3" class="reversefootnote" role="doc-backlink">&#8617;</a></p><li id="fn:1"><p>길이가 1인 벡터를 뜻합니다. \(\|v\|=1\) <a href="#fnref:1" class="reversefootnote" role="doc-backlink">&#8617;</a></p><li id="fn:5"><p>벡터 \(\boldsymbol{k}\)를 벡터 \(\boldsymbol{v}\)에 사영하여 얻을 수 있는 벡터는 \(c\boldsymbol{v}\)로 나타낼 수 있습니다 (\(c\)는 스칼라). 이때 \(c=\cfrac{\boldsymbol{k}^T \boldsymbol{v}}{\boldsymbol{v}^T \boldsymbol{v}}\)입니다. 만일 \(\boldsymbol{v}\)가 단위벡터라면 \(\boldsymbol{v}^T\boldsymbol{v}=1\) 이므로 \(c=\boldsymbol{k}^T\boldsymbol{v}\), 즉 두 벡터의 내적을 통해서 구할 수 있습니다. <a href="#fnref:5" class="reversefootnote" role="doc-backlink">&#8617;</a></p><li id="fn:4"><p>주어진 제약 조건 하에서 최댓값이나 최솟값을 찾는 최적화 문제를 푸는 방법입니다. <a href="#fnref:4" class="reversefootnote" role="doc-backlink">&#8617;</a></p><li id="fn:6"><p>정방행렬(square matrix)이면서 \(\boldsymbol{A} = \boldsymbol{A}^T\)를 만족하는 행렬을 뜻합니다. <a href="#fnref:6" class="reversefootnote" role="doc-backlink">&#8617;</a> <a href="#fnref:6:1" class="reversefootnote" role="doc-backlink">&#8617;<sup>2</sup></a></p></ol></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/math/'>Math</a>, <a href='/categories/linear-algebra/'>Linear algebra</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/pca/" class="post-tag no-text-decoration" >pca</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=PCA(주성분 분석) - 생각과 고민.&url=https://gguguk.github.io/posts/PCA/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=PCA(주성분 분석) - 생각과 고민.&u=https://gguguk.github.io/posts/PCA/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=PCA(주성분 분석) - 생각과 고민.&url=https://gguguk.github.io/posts/PCA/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/tsne/">T-SNE 이해하기</a><li><a href="/posts/how_to_work_python/">CS50 - 파이썬이 소스 코드를 실행하는 과정과 원리</a><li><a href="/posts/OIDC/">IRSA의 원리를 파헤쳐보자 4 - OIDC</a><li><a href="/posts/OAuth/">IRSA의 원리를 파헤쳐보자 3 - OAuth2.0</a><li><a href="/posts/admission_webhook/">IRSA의 원리를 파헤쳐보자 1 - K8S Admission Webhook</a></ul></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/eigenvalue_eigenvector/"><div class="card-body"> <span class="timeago small" >Jan 5, 2021<i class="unloaded">2021-01-05T22:20:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>고유값(eigen value)과 고유벡터(eigen vector)</h3><div class="text-muted small"><p> 방향은 변하지 않고 크기만 변하는 벡터를 찾아라! 두줄 요약 !! 선형 변환을 했을 때 크기는 변하나 방향은 변하지 않는 벡터를 고유벡터라고 하고 변하는 크기는 고유값이라 함 행렬 분해 기법(EVD, SVD)과 PCA 등 여러 응용 사례의 가장 기초가 되는 개념 선형대수학 개념 중 고유값(ei...</p></div></div></a></div><div class="card"> <a href="/posts/eigenvalue_decomposition/"><div class="card-body"> <span class="timeago small" >Jan 26, 2021<i class="unloaded">2021-01-26T22:18:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>고유값 분해(Eigenvalue Decompostion)</h3><div class="text-muted small"><p> 정방행렬을 고유벡터와 고유값의 행렬로 분해할 수 있다?! (Eigenvalue decomposition, OREILLY) 2줄 요약 고유값 분해는 \(n \times n\) 정방 행렬을 고유벡터로 이루어진 행렬과 고유값으로 이루어진 행렬로 대각화 하는 방법 행렬 거듭제곱, SVD 등에서 활용 됨 \(n \times n\)...</p></div></div></a></div><div class="card"> <a href="/posts/SVD/"><div class="card-body"> <span class="timeago small" >Mar 7, 2021<i class="unloaded">2021-03-07T22:19:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>특이값 분해(Singular Value Decompostion)</h3><div class="text-muted small"><p> 행렬을 직교행렬 두개와 대각행렬 하나로 분해할 수 있습니다. 3줄 요약 특이값 분해(SVD)는 \(m \times n\) 직사각 행렬 \(M\)을 직교행렬 \(U\), \(V^T\)와 고유값 행렬 \(\Sigma\)로 대갹화 하는 방법입니다. 고유값 분해(EVD)는 정방 행렬에만 적용 가능한데 반해, 특이값 분해(SVD)는 직사각 ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/eigenvalue_eigenvector/" class="btn btn-outline-primary" prompt="Older"><p>고유값(eigen value)과 고유벡터(eigen vector)</p></a> <a href="/posts/eigenvalue_decomposition/" class="btn btn-outline-primary" prompt="Newer"><p>고유값 분해(Eigenvalue Decompostion)</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://github.com/gguguk">Gukwon Koo</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/retrospective/">retrospective</a> <a class="post-tag" href="/tags/k8s/">k8s</a> <a class="post-tag" href="/tags/kubernetes/">kubernetes</a> <a class="post-tag" href="/tags/nlp/">nlp</a> <a class="post-tag" href="/tags/statistics/">statistics</a> <a class="post-tag" href="/tags/irsa/">irsa</a> <a class="post-tag" href="/tags/ml/">ml</a> <a class="post-tag" href="/tags/mlops/">mlops</a> <a class="post-tag" href="/tags/paper/">paper</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://gguguk.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-8EWVG7CHCY"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-8EWVG7CHCY'); }); </script>
