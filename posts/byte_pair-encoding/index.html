<!DOCTYPE html><html lang="en" mode="light" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate"><meta http-equiv="Expires" content="0"><meta http-equiv="Pragma" content="no-cache"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="Byte Pair Encoding" /><meta name="author" content="Gukwon Koo" /><meta property="og:locale" content="en" /><meta name="description" content="최근 NLP에서 tokenizer로 많이 사용되고 있는 BPE에 대해서 간단하게 정리해 보겠습니다. 전체코드는 이곳에서 확인해 보실 수 있습니다." /><meta property="og:description" content="최근 NLP에서 tokenizer로 많이 사용되고 있는 BPE에 대해서 간단하게 정리해 보겠습니다. 전체코드는 이곳에서 확인해 보실 수 있습니다." /><link rel="canonical" href="https://gguguk.github.io/posts/byte_pair-encoding/" /><meta property="og:url" content="https://gguguk.github.io/posts/byte_pair-encoding/" /><meta property="og:site_name" content="생각과 고민." /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-06-05T00:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Byte Pair Encoding" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@Gukwon Koo" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Gukwon Koo"},"dateModified":"2020-06-05T00:00:00+09:00","datePublished":"2020-06-05T00:00:00+09:00","description":"최근 NLP에서 tokenizer로 많이 사용되고 있는 BPE에 대해서 간단하게 정리해 보겠습니다. 전체코드는 이곳에서 확인해 보실 수 있습니다.","headline":"Byte Pair Encoding","mainEntityOfPage":{"@type":"WebPage","@id":"https://gguguk.github.io/posts/byte_pair-encoding/"},"url":"https://gguguk.github.io/posts/byte_pair-encoding/"}</script><title>Byte Pair Encoding | 생각과 고민.</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="생각과 고민."><meta name="application-name" content="생각과 고민."><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/sample/bear.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">생각과 고민.</a></div><div class="site-subtitle font-italic">주니어 데이터 사이언티스트입니다.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/gguguk" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://www.linkedin.com/in/%EA%B5%AD%EC%9B%90-%EA%B5%AC-32a9691a1/" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Byte Pair Encoding</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Byte Pair Encoding</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Gukwon Koo </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Fri, Jun 5, 2020, 12:00 AM +0900" >Jun 5, 2020<i class="unloaded">2020-06-05T00:00:00+09:00</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3220 words">17 min read</span></div></div><div class="post-content"><blockquote><p>최근 NLP에서 tokenizer로 많이 사용되고 있는 BPE에 대해서 간단하게 정리해 보겠습니다. 전체코드는 <a href="https://github.com/gwkoo82/tutorials/blob/master/nlp/BPE_generate_vocab_tutorial.ipynb">이곳</a>에서 확인해 보실 수 있습니다.</p></blockquote><h2 id="1--backgroud-subword-segmentation">1   Backgroud: Subword Segmentation</h2><p>subword segmentation(단어 분리, 단어 분절)이란, 하나의 단어(혹은 토큰)는 여러 개의 subword의 조합으로 이루어져 있다는 가정하에 subword 단위의 토크나이징을 수행하여 단어를 이해하려는 목적을 가진 전처리 작업을 말합니다. 이어서 설명할 BPE는 subword segmentation 기법 중 하나입니다.</p><h3 id="11--example">1.1   Example</h3><p>실제로 영어나 한국어는 subword 단위로 의미를 분리할 수 있는 경우가 많습니다. 아래의 예시를 보시면 그 의미를 쉽게 이해할 수 있습니다.</p><div class="table-wrapper"><table><thead><tr><th style="text-align: left">언어<th style="text-align: left">단어<th style="text-align: left">subword 구성<tbody><tr><td style="text-align: left">영어<td style="text-align: left">concentrate<td style="text-align: left">con(=together) + centr(=center) + ate(=make)<tr><td style="text-align: left">한국어<td style="text-align: left">집중<td style="text-align: left">集(모을 집) + 中(가운데 중)</table></div><p><br /></p><h2 id="2--bpebyte-pair-encoding">2   BPE(Byte Pair Encoding)</h2><p>BPE는 subword segmentation의 대표적인 알고리즘입니다. ‘byte’라는 단어에서 알 수 있듯이 원래는 데이터 압축을 위한 알고리즘으로 탄생했지만, 현재는 NLP 분야의 대표적인 토크나이징 방법으로 활용되고 있습니다. 특히 최신 NLP 모델인 BERT 등에서 기본적인 토크나이저로 활용되고 있습니다.</p><h3 id="21--merits-of-bpe">2.1   Merits of BPE</h3><ul><li><p>단어 사전의 OOV 문제 완화: subword segmentation인 BEP의 최대 장점은 <code class="language-plaintext highlighter-rouge">OOV</code> 문제를 완화할 수 있다는 것입니다. 기존의 vocabulary에 없는 신조어나 오타 등도 subword 단위나 character 단위로 토크나이징 하면 known token의 조합으로 표현가능 합니다. 예를 들어 <code class="language-plaintext highlighter-rouge">athazagoraphobia</code>처럼 기존 단어 사전에 없던 단어는 <code class="language-plaintext highlighter-rouge">UNK</code>토큰이 아니라 <code class="language-plaintext highlighter-rouge">['▁ath', 'az', 'agor', 'aphobia']</code>와 같이 subword 단위로 쪼개서 OOV 문제를 회피할 수 있습니다<a href="https://scholar.google.co.kr/scholar?hl=ko&amp;as_sdt=0%2C5&amp;q=Neural+machine+translation+of+rare+words+with+subword+units&amp;btnG=">(Sennrich et al., 2015)</a>.</p><li><p>언어에 관계없는 토크나이저 구축 가능: BPE 토크나이저는 각 언어의 특성에 적합한 사전 전처리 과정이 필요하지 않은 universal tokenizer입니다. 그러나 한국어의 경우 형태소 분석 후 BPE를 적용하는 것이 특정 태스크에서는 더 높은 스코어를 유도한다는 연구 결과도 있으므로(<a href="https://scholar.google.co.kr/scholar?hl=ko&amp;as_sdt=0%2C5&amp;q=An+Empirical+Study+of+Tokenization+Strategies+for+Various+Korean+NLP+Tasks&amp;btnG=">Park et al., 2020</a>) 진리인 것은 아닌 것 같습니다.</p></ul><h3 id="22--vocabulary-생성-방법">2.2   vocabulary 생성 방법</h3><p>BPE를 통한 토크나이징은 크게 <strong>1) 사전 구축</strong>, <strong>2) 사전을 통한 토크나이징</strong>으로 구성되어 있습니다. 본 글에서는 사전 구축에 집중하여 살펴보겠습니다. BPE는 형태소 분석을 통한 사전 구축 방법과 다르게 사용자가 학습 횟수를 임의로 조정하여 사전의 크기를 조절할 수 있는 특징이 있습니다. 사전 구축은 다음의 프로세스를 통해 이루어집니다. 먼저 논문에서는 BPE 토크나이저 구축 프로세스를 아래와 같이 언급하고 있습니다<a href="https://scholar.google.co.kr/scholar?hl=ko&amp;as_sdt=0%2C5&amp;q=Neural+machine+translation+of+rare+words+with+subword+units&amp;btnG=">(Sennrich et al., 2015)</a>.</p><blockquote><ul><li>Firstly, we initialize the symbol vocabulary with the character vocabulary<li>We iteratively count all symbol pairs and replace each occurrence of the most frequent pair (‘A’, ‘B’) with a new symbol ‘AB’<li>Each merge operation produces a new symbol which represents a character n-gram.<li>Frequent character n-grams (or whole words) are eventually merged into a single symbol, thus BPE requires no shortlist.</ul></blockquote><p>이 내용을 조금 더 자세히 풀어보면…</p><p><strong>Step 1.</strong>   corpus 내의 sentence들을 어절 단위로 분리해 둡니다.</p><p><strong>Stpe 2.</strong>   어절 단위로 분리된 token들을 character 단위로 분리(띄어쓰기 처리) 및 딕셔너리 생성(최종 vocabulary를 만들기 위한 기준으로 사용). 이때 각 word의 끝에는 <code class="language-plaintext highlighter-rouge">&lt;/w&gt;</code> 토큰을 붙여줍니다.</p><p><strong>Stpe 3.</strong>   가장 많이 등장한 pair를 찾아 merge한 후 딕셔너리를 업데이트 합니다.</p><p><strong>Stpe 4.</strong>   Step 3을 사용자가 지정한 횟수만큼 반복합니다(sentencepiece의 경우에는 최종 vocab size를 지정합니다)</p><p><strong>Stpe 5.</strong>   완성된 딕셔너리를 통해 unique token만 남은 vocabulary를 생성</p><p><strong>Stpe 6.</strong>   final vocab size = # of initial vocab size(special token 포함) + # of merge operations</p><p>참고로 step 2에서 붙여주는 <code class="language-plaintext highlighter-rouge">&lt;/w&gt;</code> 토큰은 생각보다 중요한 역할을 담당할 수 있습니다. 예를 들어 <code class="language-plaintext highlighter-rouge">est</code> 토큰을 생각해봅시다. 이 토큰은 <code class="language-plaintext highlighter-rouge">est ern</code>에 속할 수도 있고 <code class="language-plaintext highlighter-rouge">small est</code>에 속할 수도 있습니다. 이때 <code class="language-plaintext highlighter-rouge">est</code> 각 상황 마다 <code class="language-plaintext highlighter-rouge">est</code>토큰의 의미는 조금 다르게 느껴집니다. 만일 <code class="language-plaintext highlighter-rouge">est</code>가 word의 마지막에 등장하여 <code class="language-plaintext highlighter-rouge">est&lt;\w&gt;</code>로 처리한다면, 모델은 <code class="language-plaintext highlighter-rouge">est</code>의 의미를 좀더 명확히 인지할 수 있게 됩니다 [6].</p><p><br /></p><h2 id="3-bep-with-python-codes">3   BEP with python codes</h2><p>corpus는 아래와 같이 주어졌다고 가정하고 시작하겠습니다.</p><div class="language-python highlighter-rouge"><div class="code-header" text-data="python"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="n">corpus</span> <span class="o">=</span> <span class="p">[</span>
    <span class="sh">'</span><span class="s">이 영화를 영화관에서 직접 보지 못한 것을 평생 후회할 것 같다. 보는 내내 감탄을 자아냈고 절대 잊지 못할 여운으로 남을 것이다.</span><span class="sh">'</span><span class="p">,</span>
    <span class="sh">'</span><span class="s">평점이 이해되지 않는다 최소 9점은 받아야 한다 반전이 정말 끝내준다</span><span class="sh">'</span><span class="p">,</span>
    <span class="sh">'</span><span class="s">말로 표현할 수 없다 완벽한 영화 보는 내내 소름이 돋았다</span><span class="sh">'</span>
<span class="p">]</span>
</pre></table></code></div></div><h3 id="31-어절-단위-분리-및-어절-내-띄어쓰기-처리">3.1   어절 단위 분리 및 어절 내 띄어쓰기 처리</h3><p>sentence를 어절 단위로 분리한 후, 어절 token 내에서 character 단위 분리를 한번에 수행해 보겠습니다. 아래의 함수는 그러한 역할을 수행합니다.</p><div class="language-python highlighter-rouge"><div class="code-header" text-data="python"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">get_dictionary</span><span class="p">(</span><span class="n">corpus</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s"> 데이터를 읽어와 단어 사전 구축
    Args:
        corpus: 여러 텍스트 데이터가 담긴 리스트
    Returns:
        dict(vocab): 문장 데이터 별 character 단위로 구분된(띄어쓰기) 후보 사전
    </span><span class="sh">"""</span>
    <span class="n">dictionary</span> <span class="o">=</span> <span class="nf">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">corpus</span><span class="p">:</span>
        <span class="n">tokens</span> <span class="o">=</span> <span class="nf">preprocess</span><span class="p">(</span><span class="n">line</span><span class="p">).</span><span class="nf">strip</span><span class="p">().</span><span class="nf">split</span><span class="p">(</span><span class="sh">"</span><span class="s"> </span><span class="sh">"</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">tokens</span><span class="p">:</span>
            <span class="n">dictionary</span><span class="p">[</span><span class="sh">"</span><span class="s"> </span><span class="sh">"</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="nf">list</span><span class="p">(</span><span class="n">token</span><span class="p">))</span> <span class="o">+</span> <span class="sh">"</span><span class="s"> &lt;/w&gt;</span><span class="sh">"</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    
    <span class="k">return</span> <span class="nf">dict</span><span class="p">(</span><span class="n">dictionary</span><span class="p">)</span>
</pre></table></code></div></div><p>결과로 아래와 같은 <code class="language-plaintext highlighter-rouge">dictionary</code>가 생성됩니다.</p><div class="language-python highlighter-rouge"><div class="code-header" text-data="python"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="n">dictionary</span> <span class="o">=</span> <span class="nf">get_dictionary</span><span class="p">(</span><span class="n">corpus</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">dictionary</span><span class="p">)</span>

<span class="p">{</span><span class="sh">'</span><span class="s">이 &lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">영 화 를 &lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">영 화 관 에 서 &lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">직 접 &lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">보 지 &lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">못 한 &lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">것 을 &lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">평 생 &lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">후 회 할 &lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">것 &lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">같 다 &lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">보 는 &lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">내 내 &lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">감 탄 을 &lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="p">...}</span>
</pre></table></code></div></div><h3 id="32-가장-많이-등장한-character-pair-찾기">3.2   가장 많이 등장한 character pair 찾기</h3><p>dictionary에서 가장 많이 등장한 bi-gram pair를 찾아보겠습니다. 아래의 함수는 dictionary내의 bi-gram pair를 count하는 함수입니다.</p><div class="language-python highlighter-rouge"><div class="code-header" text-data="python"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">get_pairs</span><span class="p">(</span><span class="n">dictionary</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s"> 딕셔너리를 활용한 바이그램 페어 구축
        Args: 
            dictionary: 어절 token 별 character 단위로 분리된 dictionary
        Returns:
            pairs: bi-gram pair
    </span><span class="sh">"""</span>
    <span class="n">pairs</span> <span class="o">=</span> <span class="nf">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">word</span><span class="p">,</span> <span class="n">freq</span> <span class="ow">in</span> <span class="n">dictionary</span><span class="p">.</span><span class="nf">items</span><span class="p">():</span>
        <span class="n">word_lst</span> <span class="o">=</span> <span class="n">word</span><span class="p">.</span><span class="nf">split</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">word_lst</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">pairs</span><span class="p">[(</span><span class="n">word_lst</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">word_lst</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])]</span> <span class="o">+=</span> <span class="n">freq</span>
            
    <span class="k">return</span> <span class="nf">dict</span><span class="p">(</span><span class="n">pairs</span><span class="p">)</span>
</pre></table></code></div></div><p>함수의 실행 결과는 다음과 같습니다.</p><div class="language-python highlighter-rouge"><div class="code-header" text-data="python"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="n">pairs</span> <span class="o">=</span> <span class="nf">get_pairs</span><span class="p">(</span><span class="n">dictionary</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">pairs</span><span class="p">)</span>

<span class="p">{(</span><span class="sh">'</span><span class="s">이</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">&lt;/w&gt;</span><span class="sh">'</span><span class="p">):</span> <span class="mi">4</span><span class="p">,</span>
 <span class="p">(</span><span class="sh">'</span><span class="s">영</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">화</span><span class="sh">'</span><span class="p">):</span> <span class="mi">3</span><span class="p">,</span>
 <span class="p">(</span><span class="sh">'</span><span class="s">화</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">를</span><span class="sh">'</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span>
 <span class="p">(</span><span class="sh">'</span><span class="s">를</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">&lt;/w&gt;</span><span class="sh">'</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span>
 <span class="p">(</span><span class="sh">'</span><span class="s">화</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">관</span><span class="sh">'</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span>
 <span class="p">(</span><span class="sh">'</span><span class="s">관</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">에</span><span class="sh">'</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span>
 <span class="p">(</span><span class="sh">'</span><span class="s">에</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">서</span><span class="sh">'</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span>
 <span class="p">(</span><span class="sh">'</span><span class="s">서</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">&lt;/w&gt;</span><span class="sh">'</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span>
 <span class="p">(</span><span class="sh">'</span><span class="s">직</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">접</span><span class="sh">'</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span>
 <span class="p">(</span><span class="sh">'</span><span class="s">접</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">&lt;/w&gt;</span><span class="sh">'</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span>
 <span class="p">(</span><span class="sh">'</span><span class="s">보</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">지</span><span class="sh">'</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span>
 <span class="p">(</span><span class="sh">'</span><span class="s">지</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">&lt;/w&gt;</span><span class="sh">'</span><span class="p">):</span> <span class="mi">3</span><span class="p">,</span>
 <span class="p">(</span><span class="sh">'</span><span class="s">못</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">한</span><span class="sh">'</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span>
 <span class="p">(</span><span class="sh">'</span><span class="s">한</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">&lt;/w&gt;</span><span class="sh">'</span><span class="p">):</span> <span class="mi">2</span><span class="p">,</span>
 <span class="p">(</span><span class="sh">'</span><span class="s">것</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">을</span><span class="sh">'</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span>
 <span class="p">(</span><span class="sh">'</span><span class="s">을</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">&lt;/w&gt;</span><span class="sh">'</span><span class="p">):</span> <span class="mi">3</span><span class="p">,</span>
 <span class="p">(</span><span class="sh">'</span><span class="s">평</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">생</span><span class="sh">'</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span>
 <span class="p">...}</span>
</pre></table></code></div></div><p>특히 가장 많이 등장한 bi-gram pair를 찾기 위해서는 max 함수에 key값을 지정해 주면 됩니다.</p><div class="language-python highlighter-rouge"><div class="code-header" text-data="python"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nf">print</span><span class="p">(</span><span class="nf">max</span><span class="p">(</span><span class="n">pairs</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">pairs</span><span class="p">.</span><span class="n">get</span><span class="p">))</span>

<span class="p">(</span><span class="sh">'</span><span class="s">다</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">&lt;/w&gt;</span><span class="sh">'</span><span class="p">)</span>
</pre></table></code></div></div><h3 id="33--best-bi-gram-pair를-merge하고-dictionary-업데이트">3.3   best bi-gram pair를 merge하고 dictionary 업데이트</h3><p>가장 많이 등장한 bi-gram pair를 dictionary에서 찾아서 merge(공백 제거)를 진행하는 함수입니다.</p><div class="language-python highlighter-rouge"><div class="code-header" text-data="python"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">merge_dictionary</span><span class="p">(</span><span class="n">pairs</span><span class="p">,</span> <span class="n">dictionary</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s"> 가장 자주 등장한 bi-gram pair를 merge(공백 제거)
    Args:
        pairs: bi-gram pair
        dictionary: 문장 데이터 별 character 단위로 구분된(띄어쓰기) 후보 사전
    Returns:
        dict(result): 가장 자주 등장한 bi-gram pair를 merge한 dictionary
    </span><span class="sh">"""</span>
    <span class="n">result</span> <span class="o">=</span> <span class="nf">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">best_pair</span> <span class="o">=</span> <span class="nf">max</span><span class="p">(</span><span class="n">pairs</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">pairs</span><span class="p">.</span><span class="n">get</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">word</span><span class="p">,</span> <span class="n">freq</span> <span class="ow">in</span> <span class="n">dictionary</span><span class="p">.</span><span class="nf">items</span><span class="p">():</span>
        <span class="n">paired</span> <span class="o">=</span> <span class="n">word</span><span class="p">.</span><span class="nf">replace</span><span class="p">(</span><span class="sh">"</span><span class="s"> </span><span class="sh">"</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">best_pair</span><span class="p">),</span> <span class="sh">""</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">best_pair</span><span class="p">))</span>
        <span class="n">result</span><span class="p">[</span><span class="n">paired</span><span class="p">]</span> <span class="o">=</span> <span class="n">dictionary</span><span class="p">[</span><span class="n">word</span><span class="p">]</span>
    <span class="k">return</span> <span class="nf">dict</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></table></code></div></div><p>예를 들어 현재 상태의 dictionary와 pair를 통해 dictionary를 업데이트 할 경우 아래와 같은 결과를 얻을 수 있습니다.</p><p>가장 많이 등장한 (‘다’, ‘&lt;/w&gt;‘)의 경우 공백이 제거된 모습을 볼 수 있습니다.</p><div class="language-python highlighter-rouge"><div class="code-header" text-data="python"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="n">temp</span> <span class="o">=</span> <span class="nf">merge_dictionary</span><span class="p">(</span><span class="n">pairs</span><span class="p">,</span> <span class="n">dictionary</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>

<span class="p">{</span><span class="bp">...</span>
 <span class="sh">'</span><span class="s">것 &lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">같 다&lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
  <span class="bp">...</span>
 <span class="sh">'</span><span class="s">돋 았 다&lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
</pre></table></code></div></div><h3 id="34--반복을-통한-dictionary-업데이트">3.4   반복을 통한 dictionary 업데이트</h3><p>이제 반복을 통한 dictionary 업데이트를 진행해 보겠습니다. 서두에서 언급 했듯이 반복 횟수는 사용자가 지정하는 하이퍼파라미터입니다. 반복 횟수를 통해 사전의 크기를 조절 할 수 있습니다.</p><div class="language-python highlighter-rouge"><div class="code-header" text-data="python"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="n">iter_nums</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">dictionary</span> <span class="o">=</span> <span class="nf">get_dictionary</span><span class="p">(</span><span class="n">corpus</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">iter_nums</span><span class="p">):</span>
    <span class="n">pairs</span> <span class="o">=</span> <span class="nf">get_pairs</span><span class="p">(</span><span class="n">dictionary</span><span class="p">)</span>
    <span class="n">dictionary</span> <span class="o">=</span> <span class="nf">merge_dictionary</span><span class="p">(</span><span class="n">pairs</span><span class="p">,</span> <span class="n">dictionary</span><span class="p">)</span>
</pre></table></code></div></div><p>그 결과 아래의 dictionary를 얻을 수 있습니다. 공백이 포함되었던 어절 token 중 일부에서 공백이 제거된 모습을 확인 하실 수 있습니다.</p><div class="language-python highlighter-rouge"><div class="code-header" text-data="python"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre><td class="rouge-code"><pre><span class="nf">print</span><span class="p">(</span><span class="n">dictionary</span><span class="p">)</span>

<span class="p">{</span><span class="sh">'</span><span class="s">이&lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">영화를&lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">영화관에서&lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">직접&lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">보 지&lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">못 한&lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">것 을&lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">평 생 &lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">후 회 할&lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">것 &lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">같 다&lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">보는&lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">내내&lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">감 탄 을&lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">자 아 냈 고 &lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">절 대 &lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">잊 지&lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">못 할&lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">여 운 으 로&lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">남 을&lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">것 이 다&lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">평 점 이&lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">이 해 되 지&lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">않 는 다&lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">최 소 &lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">점 은 &lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">받 아 야 &lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">한 다&lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">반 전 이&lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">정 말 &lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">끝 내 준 다&lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">말 로&lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">표 현 할&lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">수 &lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">없 다&lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">완 벽 한&lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">영화 &lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">소 름 이&lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">돋 았 다&lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
</pre></table></code></div></div><h3 id="35-최종-vocabulary-생성">3.5   최종 vocabulary 생성</h3><p>반복 횟수만큼 업데이트 된 dictionary를 기반으로 vocabulary를 생성해 봅시다. vocabulary는 dictionary를 띄어쓰기 단위로 분리한 뒤, 그중 unique한 값들만 취하면 됩니다.</p><div class="language-python highlighter-rouge"><div class="code-header" text-data="python"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">get_vocab</span><span class="p">(</span><span class="n">dictionary</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s"> dictionary에서 최종 vocabulary를 만드는 함수
    Args:
        dictionary: merge가 수행된 dictionary
    Returns:
        dict(vocab): 최종 vocabulary
    </span><span class="sh">"""</span>
    <span class="n">result</span> <span class="o">=</span> <span class="nf">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">word</span><span class="p">,</span> <span class="n">freq</span> <span class="ow">in</span> <span class="n">dictionary</span><span class="p">.</span><span class="nf">items</span><span class="p">():</span>
        <span class="n">tokens</span> <span class="o">=</span> <span class="n">word</span><span class="p">.</span><span class="nf">split</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">tokens</span><span class="p">:</span>
            <span class="n">result</span><span class="p">[</span><span class="n">token</span><span class="p">]</span> <span class="o">+=</span> <span class="n">freq</span>
    <span class="k">return</span> <span class="nf">dict</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></table></code></div></div><p>마지막으로 생성된 vocabulary를 확인 해 볼까요?</p><div class="language-python highlighter-rouge"><div class="code-header" text-data="python"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
</pre><td class="rouge-code"><pre><span class="n">vocab</span> <span class="o">=</span> <span class="nf">get_vocab</span><span class="p">(</span><span class="n">dictionary</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">vocab</span><span class="p">)</span>

<span class="p">{</span><span class="sh">'</span><span class="s">이&lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">영화를&lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">영화관에서&lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">직접&lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">보</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">지&lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">못</span><span class="sh">'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">한&lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">것</span><span class="sh">'</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">을&lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">평</span><span class="sh">'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">생</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">&lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">후</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">회</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">할&lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">같</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">다&lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">보는&lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">내내&lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">감</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">탄</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">자</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">아</span><span class="sh">'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">냈</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">고</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">절</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">대</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">잊</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">여</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">운</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">으</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">로&lt;/w&gt;</span><span class="sh">'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">남</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">이</span><span class="sh">'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">점</span><span class="sh">'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">해</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">되</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">않</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">는</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">최</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">소</span><span class="sh">'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">은</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">받</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">야</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">한</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">반</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">전</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">정</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">말</span><span class="sh">'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">끝</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">내</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">준</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">표</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">현</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">수</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">없</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">완</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">벽</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">영화</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">름</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">돋</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="sh">'</span><span class="s">았</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
</pre></table></code></div></div><p><br /></p><h2 id="4-참고자료">4   참고자료</h2><ul><li><a href="https://github.com/Huffon/nlp-various-tutorials/blob/master/korean-bpe.ipynb?fbclid=IwAR10PD96wB4GDMby5VxKABpkKqwY4tpVI_wdv9mweAPzO8I2lj6GDWs_q08">월간 자연어 처리 - BPE tutorial</a><li><a href="https://kh-kim.gitbooks.io/pytorch-natural-language-understanding/content/preprocessing/bpe.html">Segmentation using Subword (Byte Pare Encoding, BPE)</a><li><a href="https://wikidocs.net/22592">단어 분리하기(Byte Pair Encoding, BPE)</a><li><a href="https://scholar.google.co.kr/scholar?hl=ko&amp;as_sdt=0%2C5&amp;q=Neural+Machine+Translation+of+Rare+Words+with+Subword+Units&amp;btnG=">Sennrich, R., Haddow, B., &amp; Birch, A. (2015). Neural machine translation of rare words with subword units. arXiv preprint arXiv:1508.07909.</a><li><a href="https://towardsdatascience.com/byte-pair-encoding-the-dark-horse-of-modern-nlp-eb36c7df4f10">Byte Pair Encoding — The Dark Horse of Modern NLP</a><li><a href="https://notebook.community/ethen8181/machine-learning/deep_learning/subword/bpe#Applying-Encodings">bpe</a><li><a href="https://scholar.google.co.kr/scholar?hl=ko&amp;as_sdt=0%2C5&amp;q=An+Empirical+Study+of+Tokenization+Strategies+for+Various+Korean+NLP+Tasks&amp;btnG=">Park, K., Lee, J., Jang, S., &amp; Jung, D. (2020). An Empirical Study of Tokenization Strategies for Various Korean NLP Tasks. <em>arXiv preprint arXiv:2010.02534</em>.</a></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ml/'>ML</a>, <a href='/categories/nlp/'>NLP</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/nlp/" class="post-tag no-text-decoration" >nlp</a> <a href="/tags/byte-pair-encoding/" class="post-tag no-text-decoration" >byte pair encoding</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Byte Pair Encoding - 생각과 고민.&url=https://gguguk.github.io/posts/byte_pair-encoding/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Byte Pair Encoding - 생각과 고민.&u=https://gguguk.github.io/posts/byte_pair-encoding/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Byte Pair Encoding - 생각과 고민.&url=https://gguguk.github.io/posts/byte_pair-encoding/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/tsne/">T-SNE 이해하기</a><li><a href="/posts/how_to_work_python/">CS50 - 파이썬이 소스 코드를 실행하는 과정과 원리</a><li><a href="/posts/OIDC/">IRSA의 원리를 파헤쳐보자 4 - OIDC</a><li><a href="/posts/OAuth/">IRSA의 원리를 파헤쳐보자 3 - OAuth2.0</a><li><a href="/posts/admission_webhook/">IRSA의 원리를 파헤쳐보자 1 - K8S Admission Webhook</a></ul></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/nlp_transfer_learning_history/"><div class="card-body"> <span class="timeago small" >Mar 5, 2020<i class="unloaded">2020-03-05T00:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>NLP Transfer Learning History</h3><div class="text-muted small"><p> 김성현 연구원님의 T아카데미 토크ON세미나 ‘딥러닝 기반의 자연어 언어 모델 BERT’ 라는 세미나를 듣고 알게된 정보와 구글링을 통해 알게된 정보를 종합하여 관련 내용을 정리해 보고자 합니다. 1   From word embedding To pretrained language models 1.1   Traditional context-fr...</p></div></div></a></div><div class="card"> <a href="/posts/fasttext/"><div class="card-body"> <span class="timeago small" >Aug 16, 2020<i class="unloaded">2020-08-16T00:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Enriching Word Vectors with Subword Information</h3><div class="text-muted small"><p> Fasttext 논문(Enriching Word Vectors with Subword Information)을 리뷰해 보았습니다. 슬라이드쉐어에 동일한 내용을 업로드 하였으며, 슬라이드쉐어에서 보시려면 이곳을 확인해 주세요. 1   Introduction 2   General Model 3   Subwor...</p></div></div></a></div><div class="card"> <a href="/posts/attention_is_all_you_need/"><div class="card-body"> <span class="timeago small" >Oct 16, 2020<i class="unloaded">2020-10-16T00:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Attention Is All You Need</h3><div class="text-muted small"><p> “Attention Is All You Need” 논문을 읽은 후 관련 자료를 정리한 내용을 바탕으로 논문 리뷰를 진행 해보겠습니다. 서론 및 문헌연구는 제외하겠습니다. 1     Model Architecture transformer에서 가장 중요한 block은 self-attention과 point-wise feed forward net...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/contiunous_random_variable/" class="btn btn-outline-primary" prompt="Older"><p>Continuous Random Variable</p></a> <a href="/posts/logit_sigmoid_softmax/" class="btn btn-outline-primary" prompt="Newer"><p>Ligit, Sigmoid, Softmax의 관계</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://github.com/gguguk">Gukwon Koo</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/retrospective/">retrospective</a> <a class="post-tag" href="/tags/k8s/">k8s</a> <a class="post-tag" href="/tags/kubernetes/">kubernetes</a> <a class="post-tag" href="/tags/nlp/">nlp</a> <a class="post-tag" href="/tags/statistics/">statistics</a> <a class="post-tag" href="/tags/irsa/">irsa</a> <a class="post-tag" href="/tags/ml/">ml</a> <a class="post-tag" href="/tags/mlops/">mlops</a> <a class="post-tag" href="/tags/paper/">paper</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://gguguk.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-8EWVG7CHCY"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-8EWVG7CHCY'); }); </script>
