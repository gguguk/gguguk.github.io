<!DOCTYPE html><html lang="en" mode="light" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate"><meta http-equiv="Expires" content="0"><meta http-equiv="Pragma" content="no-cache"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="MAB와 Thomson Sampling" /><meta name="author" content="Gukwon Koo" /><meta property="og:locale" content="en" /><meta name="description" content="MAB를 이해하기 위해 필요한 베타분포(Beta Dist.), 이항분포(Binomial Dist.), 베이지안 추정(Bayesian Estimation), 톰슨 샘플링(Tompson Sampling)과 관련된 내용을 정리하였습니다." /><meta property="og:description" content="MAB를 이해하기 위해 필요한 베타분포(Beta Dist.), 이항분포(Binomial Dist.), 베이지안 추정(Bayesian Estimation), 톰슨 샘플링(Tompson Sampling)과 관련된 내용을 정리하였습니다." /><link rel="canonical" href="https://gguguk.github.io/posts/MAB/" /><meta property="og:url" content="https://gguguk.github.io/posts/MAB/" /><meta property="og:site_name" content="생각과 고민." /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-05-07T00:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="MAB와 Thomson Sampling" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@Gukwon Koo" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Gukwon Koo"},"dateModified":"2020-05-07T00:00:00+09:00","datePublished":"2020-05-07T00:00:00+09:00","description":"MAB를 이해하기 위해 필요한 베타분포(Beta Dist.), 이항분포(Binomial Dist.), 베이지안 추정(Bayesian Estimation), 톰슨 샘플링(Tompson Sampling)과 관련된 내용을 정리하였습니다.","headline":"MAB와 Thomson Sampling","mainEntityOfPage":{"@type":"WebPage","@id":"https://gguguk.github.io/posts/MAB/"},"url":"https://gguguk.github.io/posts/MAB/"}</script><title>MAB와 Thomson Sampling | 생각과 고민.</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="생각과 고민."><meta name="application-name" content="생각과 고민."><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/sample/bear.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">생각과 고민.</a></div><div class="site-subtitle font-italic">주니어 데이터 사이언티스트입니다.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/gguguk" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://www.linkedin.com/in/%EA%B5%AD%EC%9B%90-%EA%B5%AC-32a9691a1/" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>MAB와 Thomson Sampling</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>MAB와 Thomson Sampling</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Gukwon Koo </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Thu, May 7, 2020, 12:00 AM +0900" >May 7, 2020<i class="unloaded">2020-05-07T00:00:00+09:00</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2997 words">16 min read</span></div></div><div class="post-content"><p>MAB를 이해하기 위해 필요한 베타분포(Beta Dist.), 이항분포(Binomial Dist.), 베이지안 추정(Bayesian Estimation), 톰슨 샘플링(Tompson Sampling)과 관련된 내용을 정리하였습니다.</p><p><br /></p><h2 id="1--ab-테스트-자동화의-필요성">1   A/B 테스트 자동화의 필요성</h2><p>특정 캠페인을 진행하면서, 어떤 캠페인의 배너가 더 잘 구매 전환을 유도하는지를 알기 위해 가장 간단하게 시행할 수 있는 A/B 테스트 방법은 배너별 노출 비율을 수동으로 설정하는 것입니다. 동일한 기간에 A 배너와 B 배너의 노출 비율을 50:50으로 <strong>고정하여</strong> 데이터를 수집하고 평균 분석 등의 통계적 방법론을 적용하는 것이죠. 만일 테스트 종료 후 A 배너가 B배너 보다 더 효과적으로 구매 전환을 유도하는 것으로 결론이 났다고 가정해 봅시다. 기업의 의사결정자 입장에서는 A 배너가 B 배너에 비해서 더 나은 결과를 보인다는 것을 통계적으로 확인하였으니 A 배너를 계속 노출하자는 의사결정을 하게 되겠죠.</p><p>그런데 그러한 결론을 유도하기 위한 데이터 수집기간 동안 B 배너는 어쨌든 계속 노출될수밖에 없습니다. 결과론적으로 보면 A 배너가 더 좋은 결과를 가져다주는 것을 알 수 있음에도 불구하고 말이죠. 다시말해, B 배너 노출에 따른 손실이 발생하게 된 것으로 볼 수도 있습니다.. A 배너를 더 많이 노출 했으면 더 높은 수익을 얻을 수 있었을 텐데 말이죠. 만일 A 배너와 B 배너의 노출 비율을 상황에 적합하게 <strong>실시간으로 조정할 수만 있다면</strong> 배너 노출 테스트하는 기간 동안의 기회비용을 줄일 수 있지 않을까요? 이제 MAB에 대해서 알아봅시다.</p><p><br /></p><h2 id="2--mab-문제">2   MAB 문제</h2><p>MAB(Multi-armed Bandits)란 이름에서 알 수 있듯이 도박꾼이 카지노의 여러 슬롯머신의 레버(arm)을 당겨서 최대의 이익을 달성하려는 모습에서 비롯되었습니다. 도박꾼이 최대 이익을 달성하려면 알려지지 않은 분포를 가진 여러 슬롯머신의 arm을 당겨서 데이터 패턴을 얻어내야 합니다. 그러나 주어진 자원은 한정적이기 때문에 모든 arm을 무한번 당길 수는 없습니다. 다시말해 <strong>탐색(exploration)과 선택(exploitation)의 trade-off 문제를 잘 해결할 수 있어야 한다는 것이죠</strong>. 이것이 MAB 문제 해결 전략의 핵심이라고 할 수 있습니다.</p><h3 id="21---분포의-필요성">2.1   분포의 필요성</h3><p>우리는 서비스를 진행하면서 어떤 배너에 대해 <strong>노출수</strong>와 <strong>구매 건수</strong>(목표 conversion이 구매전환 일 경우) 얻을 수 있습니다. 또한 단순한 사칙연산을 통해서 <strong>구매 전환율(구매 건수/노출수)</strong>을 얻어 낼 수 있죠. 그런데 그렇게 해서 얻어낸 구매 전환율이 실제 모수를 대표한다고 확신할 수 있을까요? 저희가 얻은 데이터는 <strong>표본</strong>에 불과하기 때문에, 단순한 표본 통계량으로는 이것이 모수를 대표한다고 단정지어 말할 수 없겠습니다. 그렇다면 얻어진 구매 전환율이 어느정도의 신뢰도 혹은 확신도로 실제 모수를 반영하고 있는지를 ‘정량적’ 지표로 나타낼 수 없을까요? <strong>베타분포(beta)와 이항분포(binomial)를 통해서 표본 데이터에 기반한 모수의 신뢰도를 지속적으로 업데이트 할 수 있습니다.</strong></p><p>결론부터 말하자면 사전확률분포와 데이터 발생 분포를 각각 베타분포, 이항분포로 가정하면, 사후확률분포도 베타분포임을 도출할 수 있습니다(베타분포는 이항분포의 켤레사전확률분포). 베타분포는 2개의 모수 \(\alpha, \beta\)를 통해 분포의 모양을 비교적 자유롭게 바꿀 수 있으며, 확률변수가 0~1사이의 실수값이므로, ‘구매 전환율’의 신뢰도를 나타내기의 안성맞춤인 분포이죠.</p><h3 id="22---사전-분포-베타분포beta-distribution">2.2   사전 분포: 베타분포(beta distribution)</h3><p>베타분포는 \(RV = \theta(\in [0,1])\)을 가지는 분포를 말합니다. 여기서 \(\theta\)는 0~1사이의 실수값을 가지므로, <code class="language-plaintext highlighter-rouge">확률</code>로 해석할 여지가 있습니다. \(\theta\)를 구매 전환율로 볼때, 표본 데이터를 통해 도출한 전환율이 실제 모수임을 어느 정도의 확신 혹은 신뢰할 수 있는지를 이끌어 낼 수 있습니다.</p>\[\begin{aligned} Beta(\alpha, \beta) &amp;= f(\theta; \alpha, \beta) = P(\theta; \alpha, \beta) \\\\ &amp;= \cfrac{\theta^{\alpha-1}(1-\theta)^{\beta-1}}{B(\alpha, \beta)}\space, \theta \in [0, 1] \\\\ &amp;=\cfrac{\Gamma(\alpha+\beta)}{\Gamma(\alpha)\Gamma(\beta)}\space\theta^{\alpha-1}(1-\theta)^{\beta-1} \end{aligned}\] \[B(\alpha, \beta) = \int_{0}^{1}\theta^{\alpha-1}(1-\theta)^{\beta-1}d\theta = \cfrac{\Gamma(\alpha)\Gamma(\beta)}{\Gamma(\alpha+\beta)}\]<h3 id="23---데이터-분포가능도-분포-이항분포binomial-distibution">2.3   데이터 분포(가능도 분포): 이항분포(binomial distibution)</h3><p>이항분포는 독립적인 베르누이 시행을 \(n\)번 시행했을 때의 성공 횟수 \(k\) 에 대한 분포를 나타냅니다. 이항분포의 <code class="language-plaintext highlighter-rouge">PDF</code>는 다음과 같습니다.</p>\[\begin{aligned} P(X=k|\theta) &amp;= B(n, \theta)\\ &amp;=\binom{n}{k} \theta^{k}(1-\theta)^{n-k} \end{aligned}\]<blockquote><p>이항분포에 왜 조합(combination)이 있을까요? 독립적인 동전 던지기 시행을 5번 했을 때, 2번 성공(=앞면이 나옴) 했을 때를 가정해봅시다. 첫번째, 세번째에서 동전의 앞면이 나왔을 때와 두번째 다섯번째에서 동전이 앞면이 나오는 경우는 모두 같은 확률을 나타냅니다. 다시말해, 5개 중 2개를 순서와 상관없이 뽑는 경우를 모두 고려해야하며, 각각의 사건은 서로 배반사건(disjoint, 동시에 발생할 수 없음)입니다.</p></blockquote><h3 id="24---사후-분포-베타분포beta-distribution">2.4   사후 분포: 베타분포(beta distribution)</h3><p>사후 분포는 사전 분포인 베타분포 \(P(\theta)\)와 데이터 분포인 이항분포 \(P(k)\)의 조건부 결합 확률 밀도 함수(joint probability density function)으로로 나타낼 수 있습니다. 결합 확률 밀도 함수에 대한 자세한 내용은 <a href="https://drive.google.com/file/d/1VmkAAGOYCTORq1wxSQqy255qLJjTNvBI/view">이곳</a>을 참조해 주세요. 아래 식의 결론은 <strong>가능도 분포가 이항분포이고 사전확률분포가 베타분포이면 사후 확률분포도 베타분포라는 결론을 나타냅니다.</strong></p>\[\begin{aligned} P(\theta|X=k) &amp;= \cfrac{P(X=k|\theta)P(\theta)}{P(X=k)} \\\\ &amp;=\cfrac{P(X=k|\theta)P(\theta)}{\int_{0}^{1} P(X=k|\theta)P(\theta)d\theta} \\\\ &amp;= \cfrac{P(X=k|\theta)P(\theta)}{\int_{0}^{1} P(X=k|\theta)P(\theta)d\theta} \\\\ &amp;= \cfrac{\dbinom{n}{k} \theta^k(1-\theta)^{(n-k)}{\cfrac{\theta^{\alpha-1}\theta^{\beta-1}}{B(\alpha, \beta)}}}{\int P(k|\theta)P(\theta)d\theta} \\\\ &amp;= \cfrac{\dbinom{n}{k}{\cfrac{\theta^{(\alpha+k)-1}\theta^{(\beta+n-k)-1}}{B(\alpha, \beta)}}}{\int_{0}^{1} P(X=k|\theta)P(\theta)d\theta} \\\\ &amp;= \cfrac{\dbinom{n}{k}{\cfrac{\theta^{(\alpha+k)-1}\theta^{(\beta+n-k)-1}}{B(\alpha, \beta)}}}{\int_{0}^{1}\dbinom{n}{k}\theta^{k}(1-\theta)^{n-k} \cfrac {\theta^{\alpha-1}\theta^{\beta-1}} {B(\alpha, \beta)} } \\\\ &amp;= \cfrac{\dbinom{n}{k}{\cfrac{\theta^{(\alpha+k)-1}\theta^{(\beta+n-k)-1}}{B(\alpha, \beta)}}}{\dbinom{n}{k} \cfrac{1}{B(\alpha, \beta)}\int_{0}^{1}\theta^{k}(1-\theta)^{n-k} \theta^{\alpha-1}\theta^{\beta-1}} \\\\ &amp;= \cfrac{\dbinom{n}{k}{\cfrac{\theta^{(\alpha+k)-1}\theta^{(\beta+n-k)-1}}{B(\alpha, \beta)}}}{\dbinom{n}{k} \cfrac{1}{B(\alpha, \beta)}\int_{0}^{1}\theta^{\alpha+k-1}(1-\theta)^{\beta+n-k-1}} \\\\ &amp;= \cfrac{\dbinom{n}{k}{\cfrac{\theta^{(\alpha+k)-1}\theta^{(\beta+n-k)-1}}{B(\alpha, \beta)}}}{\dbinom{n}{k} \cfrac{B(\alpha+k, \beta+n-k)}{B(\alpha, \beta)}} \\\\ &amp;= \cfrac{1}{B(\alpha+k, \space \beta+n-k)} \space \theta^{(\alpha+k)-1}(1-\theta)^{(\beta+n-k)-1} \\\\ &amp;= Beta(\alpha+k, \space \beta+(n-k)) \end{aligned}\]<p>참고로 \(P(X=k)\)는 결합확률분포의 관점에서는 marginal probability이므로, 전확률의 법칙에 따라 아래와 같이 쓸수 있습니다.</p>\[\begin{aligned} P(k) &amp;= \int P(X=k, \theta)d\theta \\ &amp;= \int P(X=k|\theta)P(\theta)d\theta \end{aligned}\]<h3 id="25---켤레-사전-확률-분포conjugate-prior-distribution">2.5   켤레 사전 확률 분포(conjugate prior distribution)</h3><p>켤레 분포란, 모수는 다르지만, 사전 분포와 사후 분포의 형태를 같게 하는 사전 분포를 뜻합니다.</p><p>사전분포와 데이터 분포를 각각 베타분포, 이항분포로 가정했을 때, 사후분포는 베타분포이므로 <strong>사전분포는 켤레 사전 확률 분포</strong>라고 할 수 있습니다.</p><p><br /></p><h2 id="3--배너-선택-전략-톰슨-샘플링thompson-sampling">3   배너 선택 전략: 톰슨 샘플링(Thompson Sampling)</h2><p>톰슨 샘플링이란, 도출된 베타 분포에서 확률변수의 observaion을 샘플링하는 기법을 말합니다. 배너 \(A\)의 <code class="language-plaintext highlighter-rouge">conversion</code> 횟수, <code class="language-plaintext highlighter-rouge">expression</code> 횟수를 알고 있으면, \(\alpha_{A}\)와 \(\beta_{A}\)를 다음과 같이 정의할 수 있고 이 두가지 모수만 있으면 각 배너의 베타분포를 그릴 수 있습니다.</p><p>\(\alpha_{A} =\) 배너 \(A\)의 <code class="language-plaintext highlighter-rouge">conversion</code> 횟수</p><p>\(\beta_{A} =\) 배너 \(A\)의 <code class="language-plaintext highlighter-rouge">expression</code> 횟수 \(-\) 배너 \(A\)의 <code class="language-plaintext highlighter-rouge">conversion</code> 횟수</p><p>쉽게 와 닿지 않으니 예시를 들어서 설명해보겠습니다. 배너 A는 expression 13회, conversion 4회. 배너 B는 expression 11회, conversion 5회라면 각 배너의 베타 분포는 아래와 같이 나타납니다.</p><p><img data-proofer-ignore data-src="https://images.velog.io/images/gwkoo/post/4223a290-e663-4945-8a0b-578cc04b7200/image.png" alt="" /></p><p>여기서 노출시킬 배너를 선택할 수 있는 가장 쉬운 방법은 배너 A와 배너 B의 conversion rate의 기댓값을 뽑아서 기댓값이 높은 배너를 노출 시키는 전략을 취하면 될 것 같습니다. 현재 예시에서 배너 A의 conversion rate 기댓값은 0.307, 배너 B의 conversion rate 기댓값은 0.454입니다. 따라서 우리는 배너 B만 계속 노출시키면 되겠군요(0.307&lt;0.454).</p><p><img data-proofer-ignore data-src="https://images.velog.io/images/gwkoo/post/ffca03ac-e738-447e-8746-53822cb1e4b8/image.png" alt="" /></p><p>그러나 한번만 더 생각 해봅시다. conversion rate의 기댓값이 높은 배너만 계속해서 노출시키는 것이 좋은 판단인지에 대해서 말이죠. 배너 B가 배너 A에 비해 초기 어느 시점에서는 기댓값이 높을 수는 있습니다. 그러나 이러한 현상이 ‘우연히’ 발생 했을 수도 있지 않을까요? 우연히 배너 B를 선호하는 고객이 데이터 수집기간 초기 어느 시점에 잔뜩 유입돼서 배너 B에 편향된 결과를 만들 수도 있었지 않을까요? <strong>우리는 배너 A에 대한 충분한 탐색(exploration)을 하지 못했습니다.</strong></p><p>아래의 <code class="language-plaintext highlighter-rouge">Algorithm 3.1</code>이 greedy 방식의 sampling을 나타냅니다. 우리는 <code class="language-plaintext highlighter-rouge">Algorithm 3.2</code> 방식의 톰슨 샘플링을 적용해 보겠습니다. 톰슨 샘플링이란 단순히 기대값이 높은 arm을 선택하는 것이 아니라 베타 분포에서 랜덤 샘플링을 통해 적절한 탐색(exploration)을 진행하고, 새로 관찰된 데이터를 기반으로 베타 분포를 업데이트 하는 방식을 통해 각 arm에 대한 모수를 추정해 나가는 기법을 말합니다. <strong>톰슨 샘플링 기법을 활용하면 탐색(exploration)과 선택(exploitation)을 적절하게 수행해 나갈 수 있습니다.</strong></p><p><img data-proofer-ignore data-src="/assets/img/post_img/tompson_sampling.png" alt="tompson_sampling" /><em><a href="https://arxiv.org/pdf/1707.02038.pdf">Russo, D., Van Roy, B., Kazerouni, A., Osband, I., &amp; Wen, Z. (2017). A tutorial on thompson sampling.</a></em></p><p>계속 예시를 들어보죠. 톰슨 샘플링 결과 배너 A에서는 0.337, 배너 B에서는 0.271가 샘플링 되었습니다. 배너 A의 conversion rate 기댓값은 더 낫지만, 현재 시점에서는 샘플링 된 conversion rate가 더 큰 배너 A를 노출 시키는 전략(exploration)을 취하면 되겠습니다.</p><p><img data-proofer-ignore data-src="https://images.velog.io/images/gwkoo/post/2d870112-c9cc-4585-a42c-ea9da2db30c5/fig1.png" alt="" /></p><p>결과적으로 N개의 배너 당 2개의 값(conversion 횟수, expression 횟수)만 계속 저장 및 업데이트하면, 베타 분포와 톰슨 샘플링 알고리즘을 통해 적절한 exploration과 exploitation을 진행하여 최적의 배너를 통계 기반으로 찾아갈 수 있겠습니다.</p><p><br /></p><h2 id="4--베이지안-확률값의-비교--각-배너간-theta의-차이가-통계적으로-유의미할까추후-업데이트">4   베이지안 확률값의 비교: 각 배너간 \(\theta\)의 차이가 통계적으로 유의미할까?(추후 업데이트)</h2><ul><li>각 배너간 구매전환율이 실질적으로 차이가 있는지를 베이지안 확률로 도출할 수 있음<li>p-value에 의한 가설 검정(빈도주의 방식)은 여러가지 문제점은 안고 있음<li>베이지안 방법으로 A/B 테스트를 해보자는 것이 요지<li>https://brunch.co.kr/@gimmesilver/152324</ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ml/'>ML</a>, <a href='/categories/recommender/'>Recommender</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/mab/" class="post-tag no-text-decoration" >MAB</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=MAB와 Thomson Sampling - 생각과 고민.&url=https://gguguk.github.io/posts/MAB/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=MAB와 Thomson Sampling - 생각과 고민.&u=https://gguguk.github.io/posts/MAB/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=MAB와 Thomson Sampling - 생각과 고민.&url=https://gguguk.github.io/posts/MAB/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/tsne/">T-SNE 이해하기</a><li><a href="/posts/how_to_work_python/">CS50 - 파이썬이 소스 코드를 실행하는 과정과 원리</a><li><a href="/posts/OIDC/">IRSA의 원리를 파헤쳐보자 4 - OIDC</a><li><a href="/posts/OAuth/">IRSA의 원리를 파헤쳐보자 3 - OAuth2.0</a><li><a href="/posts/admission_webhook/">IRSA의 원리를 파헤쳐보자 1 - K8S Admission Webhook</a></ul></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/nlp_transfer_learning_history/"><div class="card-body"> <span class="timeago small" >Mar 5, 2020<i class="unloaded">2020-03-05T00:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>NLP Transfer Learning History</h3><div class="text-muted small"><p> 김성현 연구원님의 T아카데미 토크ON세미나 ‘딥러닝 기반의 자연어 언어 모델 BERT’ 라는 세미나를 듣고 알게된 정보와 구글링을 통해 알게된 정보를 종합하여 관련 내용을 정리해 보고자 합니다. 1   From word embedding To pretrained language models 1.1   Traditional context-fr...</p></div></div></a></div><div class="card"> <a href="/posts/byte_pair-encoding/"><div class="card-body"> <span class="timeago small" >Jun 5, 2020<i class="unloaded">2020-06-05T00:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Byte Pair Encoding</h3><div class="text-muted small"><p> 최근 NLP에서 tokenizer로 많이 사용되고 있는 BPE에 대해서 간단하게 정리해 보겠습니다. 전체코드는 이곳에서 확인해 보실 수 있습니다. 1   Backgroud: Subword Segmentation subword segmentation(단어 분리, 단어 분절)이란, 하나의 단어(혹은 토큰)는 여러 개의 subword의 조합으로 이...</p></div></div></a></div><div class="card"> <a href="/posts/logit_sigmoid_softmax/"><div class="card-body"> <span class="timeago small" >Jun 7, 2020<i class="unloaded">2020-06-07T00:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Ligit, Sigmoid, Softmax의 관계</h3><div class="text-muted small"><p> 왜 NN의 출력층에 sigmoid, softmax 함수를 사용할까요? 이는 출력층의 값을 ‘확률’로서 표현하기 위한 필연적 결과입니다. 본 글에서는 logit, sigmoid, softmax의 관계에 대해서 정리해보았습니다. 1. Basic 앞으로 내용을 전개할 때 중요하게 사용되는 bayes theorem(베이즈 정리) 및 law of to...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/nlp_transfer_learning_history/" class="btn btn-outline-primary" prompt="Older"><p>NLP Transfer Learning History</p></a> <a href="/posts/contiunous_random_variable/" class="btn btn-outline-primary" prompt="Newer"><p>Continuous Random Variable</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://github.com/gguguk">Gukwon Koo</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/retrospective/">retrospective</a> <a class="post-tag" href="/tags/k8s/">k8s</a> <a class="post-tag" href="/tags/kubernetes/">kubernetes</a> <a class="post-tag" href="/tags/nlp/">nlp</a> <a class="post-tag" href="/tags/statistics/">statistics</a> <a class="post-tag" href="/tags/irsa/">irsa</a> <a class="post-tag" href="/tags/ml/">ml</a> <a class="post-tag" href="/tags/mlops/">mlops</a> <a class="post-tag" href="/tags/paper/">paper</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://gguguk.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-8EWVG7CHCY"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-8EWVG7CHCY'); }); </script>
