---
title: T-SNE μ΄ν•΄ν•κΈ°
author: Gukwon Koo
categories: [ML, Basic]
tags: [tsne]
pin: false
math: true
comments: false
date: 2025-08-30 14:52:00 +0900
---

T-SNEλ” κ³ μ°¨μ›μ μ„λ² λ”©μ„ μ €μ°¨μ›μΌλ΅ λ³€ν™ν•κ³  μ‹κ°ν™”ν™”μ—¬ μ„λ² λ”©μ„ ν’μ§λ“¤ λ€λµμ μΌλ΅ νμ•…ν•λ” κ²ƒμ„ λ•λ” λ€ν‘μ μΈ μ°¨μ› μ¶•μ† μ•κ³ λ¦¬μ¦μ…λ‹λ‹¤. μ‹¤μ λ΅ μ•„μ§λ„ ν„μ—…μ—μ„λ„ λ§μ΄ μ‚¬μ©λλ” μ•κ³ λ¦¬μ¦μ΄κ³ , μ—¬λ¬ λ…Όλ¬Έμ—μ„λ„ μ„λ² λ”©μ μ§μ„ μ‹κ°μ μΌλ΅ λ³΄μ—¬μ£ΌκΈ° μ„ν• λ°©λ²•μΌλ΅ λ§μ΄ ν™μ©λκ³  μμµλ‹λ‹¤.

κ·Έλ¬λ‚ μ–΄λ μκ°„ T-SNEμ μ›λ¦¬λ¥Ό μ™„λ²½ν•κ² μ΄ν•΄ν•μ§€ λ»ν•κ³  μ‚¬μ©ν•κ³  μλ‹¤λ” μƒκ°μ΄ λ“¤μ—μµλ‹λ‹¤. π«  μ•μΌλ΅ ν„μ—…μ—μ„ μ„λ² λ”©μ„ λ‹¤λ£° μΌμ΄ λ§μ•„μ§ κ²ƒ κ°™μ€ λλ‚μ΄ λ“¤μ–΄μ„ μ΄λ² κΈ°νμ— μ •ν™•ν• λ™μ‘ μ›λ¦¬λ¥Ό κ³µλ¶€ν•΄λ³΄μ•μµλ‹λ‹¤. κ³µλ¶€ν•΄λ³΄λ‹ ML κΈ°μ΄ μ΄λ΅ μ„ λ³µμµν•κΈ°μ—λ„ μΆ‹μ€ μ•κ³ λ¦¬μ¦μ΄λΌλ” μƒκ°μ΄ λ“¤λ”λΌκµ¬μ”. μ•μΌλ΅ μ„¤λ… λ“λ¦΄ λ‚΄μ©μ€ λ‹¤μμ λ°°κ²½ μ§€μ‹μ„ μ”κµ¬ν•©λ‹λ‹¤.

- Gaussian distribution
- Student-T distribution
- KL-Divergence
- Gradient decent

<br>

# Summary

---

- T-SNEλ” κ³ μ°¨μ› λ°μ΄ν„°λ¥Ό μ €μ°¨μ›μΌλ΅ λ‚΄λ¦΄ λ•, μ£Όλ³€ μ΄μ›ƒ μ •λ³΄λ¥Ό μµλ€ν• λ³΄μ΅΄ν•λ” μ•κ³ λ¦¬μ¦μ…λ‹λ‹¤.
- κ³ μ°¨μ›μ—μ„ κ°€κΉμ΄ λ°μ΄ν„°λ” μ €μ°¨μ›μ—μ„λ„ κ°€κΉκ² λ§λ“λ” κ²ƒμ΄ λ©ν‘μ…λ‹λ‹¤. μ΄λ¥Ό μ„ν•΄ κΈ°μ΄ ν†µκ³„, μµμ ν™” μ΄λ΅ μ„ ν™μ©ν•©λ‹λ‹¤.

<br>

# T-SNE = Gaussian + Student T + KL-Divergence + Gradient Decent

---

T-SNEμ ν•µμ‹¬ μ‘λ™ μ›λ¦¬λ” 4κ°μ ν‚¤μ›λ“λ΅ ν‘ν„ν•  μ μμµλ‹λ‹¤.

- **Gaussian distribution**: κ³ μ°¨μ› κ³µκ°„(μ›λ λ²΅ν„°λ“¤μ΄ μ΅΄μ¬ν•λ” κ³µκ°„)μ„ κ°€μ°μ‹μ• λ¶„ν¬λ΅ ν‘ν„ν•©λ‹λ‹¤. μ΄λ• μ›λ κ°€κΉμ΄ λ²΅ν„°λ“¤μ€ λ†’μ€ ν™•λ¥ κ°’μ„ κ°–λ„λ΅, κ·Έ λ°λ€λ” λ°λ€κ°€ λλ„λ΅ ν•©λ‹λ‹¤.
- **Student T-distribution**: μ €μ°¨μ› κ³µκ°„(μ‹κ°ν™”λ¥Ό μ„ν• κ³µκ°„, μΌλ°μ μ„ 2~3μ°¨μ›)μ„ T λ¶„ν¬λ΅ ν‘ν„ν•©λ‹λ‹¤. μ΄λ• κ³ μ°¨μ›μ—μ„ μ›λ κ°€κΉμ΄ λ²΅ν„°λ“¤μ€ λ†’μ€ ν™•λ¥ μ„ κ°€μ§€λ„λ΅, κ·Έ λ°λ€λ” λ°λ€κ°€ λλ„λ΅ ν‘ν„ν•λ” T λ¶„ν¬λ¥Ό μ°Ύλ” κ²ƒμ΄ λ©ν‘μ…λ‹λ‹¤.
- **KL-Divergence**: κ°€μ°μ‹μ• λ¶„ν¬μ™€ T λ¶„ν¬κ°€ μ°¨μ΄κ°€ λ‚λ” μ •λ„λ¥Ό κ³„μ‚°ν•©λ‹λ‹¤.
- **Gradient Decent**: KL-Divergenceμ κ°’μ— λ€ν• μ €μ°¨μ› λ²΅ν„°μ gradientλ¥Ό κ³„μ‚°ν•κ³ , KL-Divergenceκ°€ μ‘μ•„μ§€λ” λ°©ν–¥μΌλ΅ μ €μ°¨μ› λ²΅ν„°λ¥Ό μ μ§„μ μΌλ΅ μ΄λ™μ‹ν‚µλ‹λ‹¤.

<br>

#  μμ‹λ΅ ν•™μµ λ°©μ‹ μ§κ΄€μ μΌλ΅ μ΄ν•΄ν•΄ λ³΄κΈ°

---

T-SNEμ ν•™μµ λ°©μ‹μ„ μμ‹λ¥Ό λ“¤μ–΄λ΄…μ‹λ‹¤. μ§κ΄€μ μΌλ΅ μ΄ν•΄ν•κΈ° μ‰¬μΈ κ±°μμ”. T-SNEλ” λ¨Όμ € κ³ μ°¨μ›μ—μ„ κ° λ°μ΄ν„° ν¬μΈνΈ(μ: ν•™μƒ A, B)κ°€ μ„λ΅ **μ–Όλ§λ‚ κ°€κΉμ΄μ§€λ¥Ό κ³„μ‚°**ν•©λ‹λ‹¤.

- κ°€κΉμ°λ©΄: μ΄ λ‘μ€ μ„λ΅ λΉ„μ·ν•λ„¤
- λ©€λ©΄: μ΄ λ‘μ€ μ„λ΅ λ‹¤λ¥΄λ„¤

<br>

κ°™μ€ λ§μ„ **ν™•λ¥ **λ΅ ν‘ν„ν•λ©΄ μ΄λ ‡κ²λ„ ν‘ν„ν•  μ μμµλ‹λ‹¤.

- κ°€κΉμ°λ©΄: μ΄ λ‘μ΄ μ„λ΅ μΉκµ¬μΌ ν™•λ¥ μ€ 0.8
- λ©€λ©΄: μ΄ λ‘μ΄ μ„λ΅ μΉκµ¬μΌ ν™•λ¥ μ€ 0.1

<br>

μ΄μ  λ°μ΄ν„° ν¬μΈνΈλ¥Ό μ €μ°¨μ› κ³µκ°„(μ: 2μ°¨μ›)μ— λ°°μΉν•λ”λ°, μ΄ λ• **μ„μ—μ„ κ³„μ‚°ν• μΉκµ¬μΌ ν™•λ¥ μ„ μµλ€ν• μ μ§€ν•λ” κ²ƒ**μ΄ μ¤‘μ”ν•©λ‹λ‹¤.

- κ³ μ°¨μ›μ—μ„ **κ°€κΉμ› λ‹¤λ©΄**: μ €μ°¨μ› κ³µκ°„μ—μ„λ„ μ„λ΅ μΉκµ¬μΌ ν™•λ¥ μ„ **ν¬κ²**
- κ³ μ°¨μ›μ—μ„ **λ©€μ—λ‹¤λ©΄**: μ €μ°¨μ› κ³µκ°„μ—μ„λ„ μ„λ΅ μΉκµ¬μΌ ν™•λ¥ μ„ **μ‘κ²**

<br>

κ³ μ°¨μ› κ³µκ°„μ ν™•λ¥ κ³Ό μ €μ°¨μ› κ³µκ°„μ ν™•λ¥  κµ¬μ΅°λ¥Ό λΉ„μ·ν•κ² μ μ§€ν•κΈ° μ„ν•΄μ„ **λ²μ μ„ λ¶€κ³Ό**ν•©λ‹λ‹¤.

- κ³ μ°¨μ›μ—μ„ κ°€κΉμ› μ§€λ§(ν™•λ¥  νΌ) μ €μ°¨μ›μ—μ„ λ©€λ©΄(ν™•λ¥  μ‘μ): λ²μ μ΄ μ»¤μ§
- κ³ μ°¨μ›μ—μ„ κ°€κΉμ› κ³ (ν™•λ¥  νΌ) μ €μ°¨μ›μ—μ„λ„ κ°€κΉμ°λ©΄(ν™•λ¥  νΌ): λ²μ μ΄ μ‘μ•„μ§

<br>

λ§μ§€λ§‰μΌλ΅ μ΄ **λ²μ μ„ μ¤„μ΄κΈ° μ„ν• λ°©ν–¥**μΌλ΅ **μ €μ°¨μ› κ³µκ°„μ λ°μ΄ν„° ν¬μΈν„°λ¥Ό μ μ§„μ μΌλ΅ μ΄λ™**μ‹ν‚µλ‹λ‹¤.

- λ²μ μ΄ ν° λ²΅ν„°: λ²μ μ΄ μ‘μ•„μ§€λ” λ°©ν–¥μΌλ΅ ν¬κ² μ΄λ™ μ‹ν‚΄
- λ²μ μ΄ μ‘μ€ λ²΅ν„°: λ²μ μ΄ μ‘μ•„μ§€λ” λ°©ν–¥μΌλ΅ μ‘κ² μ΄λ™ μ‹ν‚΄

<br>

# μμ‹κ³Ό ν•¨κ» λ” μμ„Έν μ΄ν•΄ν•΄ λ³΄κΈ°

---

T-SNEμ ν•™μµ λ°©μ‹μ„ μμ‹λ¥Ό ν†µν•΄ μ§κ΄€μ μΌλ΅ μ΄ν•΄ν•΄ λ³΄μ•μµλ‹λ‹¤. μ΄μ  μμ‹μ„ κ³λ“¤μ—¬μ„ μΆ€ λ” μμ„Έν μ΄ν•΄ν•΄ λ³΄μ£ !



## κ³ μ°¨μ› ν™•λ¥  λ¶„ν¬ μ •μ - κ°€μ°μ‹μ• λ¶„ν¬

![](/assets/img/post_img/normal_distribution_pdf.png){:width="500"}_κ°€μ°μ‹μ• λ¶„ν¬_



T-SNEλ” κ³ μ°¨μ› κ³µκ°„μ— λ°μ΄ν„° ν¬μΈνΈ $$ x_i, \cdots, x_N $$κ°€ μμ„ λ•($$i \neq j$$) $$x_i$$μ™€ $$x_j$$μ μ μ‚¬λ„(κ±°λ¦¬)μ— λΉ„λ΅€ν•λ” ν™•λ¥  λ¶„ν¬ $$p_{ij}$$λ¥Ό κ³„μ‚°ν•λ” κ²ƒμ΄ μ²«λ²μ§Έ λ©ν‘μ…λ‹λ‹¤. μ΄λ¥Ό μ„ν•΄ $$x_i$$κ°€ $$x_j$$λ¥Ό μ΄μ›ƒμΌλ΅ μ„ νƒν•  ν™•λ¥  $$p_{j \mid i}$$λ¥Ό μ΅°κ±΄λ¶€ ν™•λ¥ λ΅ λ‚νƒ€λƒ…λ‹λ‹¤. μ΄ λ•, $$p_{i \mid i} = 0$$μ΄κ³  $$\sum_{j}P_{j \mid i}=1, \forall i$$μ…λ‹λ‹¤.



$$
p_{j \mid i} = \frac{\exp\!\left(-\| \mathbf{x}_i - \mathbf{x}_j \|^2 / 2\sigma_i^2 \right)}
{\sum_{k \neq i} \exp\!\left(-\| \mathbf{x}_i - \mathbf{x}_k \|^2 / 2\sigma_i^2 \right)}
$$



μ΄ μμ‹μ€ $$\mathbf{x}_i$$λ¥Ό **ν‰κ· **μΌλ΅ ν•λ” **κ°€μ°μ‹μ• λ¶„ν¬**μ μμ‹κ³Ό μ‚¬μ‹¤μƒ κ°™λ‹¤λ” κ²ƒμ„ μ• μ μμµλ‹λ‹¤.



$$
N(x; \mu, \sigma^2) = \cfrac{1}{\sqrt{2\pi\sigma^2}} \exp(- (x-\mu)^2/2\sigma^2)
$$

<br>

μ¦‰, κ³ μ°¨μ› κ³µκ°„μ—μ„μ λ²΅ν„°μ κ±°λ¦¬λ¥Ό ν™•λ¥ λ΅ λ³€ν™ν•λ”λ° μ΄λ• κ°€μ°μ‹μ• λ¶„ν¬λ¥Ό ν™μ©ν•λ‹¤λ” κ²ƒμ„ μ• μ μμµλ‹λ‹¤. λν• $$p_{j \mid i}$$μ λ¶„λ¨μ μμ‹μ— μν•΄ μ‹μ΄ λ…Έλ§λΌμ΄μ¦ λλ©΄μ„ $$\sum_{j}P_{j \mid i}=1, \forall i$$κ°€ λ§μ΅±λ  μ μμμ„ μ• μ μμµλ‹λ‹¤.

<br>

λ§μ§€λ§‰μΌλ΅ μ΅°κ±΄λ¶€ ν™•λ¥ μ„ λ€μΉ­ ν™•λ¥ λ΅ λ³€ν™ν•μ—¬ μ΄λ” $$x_i$$μ™€ $$x_j$$κ°€ μ΄μ›ƒμΌ μµμΆ… ν™•λ¥ μ„ κµ¬ν•©λ‹λ‹¤. μ΄λ ‡κ² ν•λ” μ΄μ λ” $$p_{j \mid i}$$μ™€ $$p_{i \mid j}$$μ λ¶„ν¬κ°€ λ‹¤λ¥΄κΈ° λ•λ¬Έμ…λ‹λ‹¤(λ¶„λ¨κ°€ λ‹¤λ¦…λ‹λ‹¤).



$$
p_{ij} = \cfrac{p_{j \mid i} + p_{i \mid j}}{2N} \text{, where N=number of dimension}
$$

<br>

μ•„μ§ $$p_{j \mid i}$$μ„ κ³„μ‚°ν•κΈ° μ„ν•΄ ν•„μ”ν• $$\sigma_i^2$$λ¥Ό μ„¤λ…ν•μ§€ μ•μ•μµλ‹λ‹¤. μ΄ κ°’μ€ $$x_i$$λ¥Ό μ¤‘μ‹¬μΌλ΅ ν• κ°€μ°μ‹μ• λ¶„ν¬μ λ¶„μ‚°μ…λ‹λ‹¤. ν•μ§€λ§ μ΄ κ°’μ€ μ•„μ§ μ •ν™•ν κ³„μ‚°ν•  μλ” μ—†μµλ‹λ‹¤. μ΄λ ‡κ² μƒκ°ν•  μλ„ μμµλ‹λ‹¤. 

> "κ·Έλƒ¥ κΈ°μ΄μ μΈ λ¶„μ‚° κ³µμ‹μ— λ”°λΌ κ³„μ‚°ν•  μ μλ” κ±° μ•„λ‹μ•Ό?" 

<br>

μ‚¬μ‹¤μ€ λ§λ” λ§μ…λ‹λ‹¤. κ·Έλ¬λ‚ T-SNE μ•κ³ λ¦¬μ¦μ€ μ΄λ ‡κ² ν•μ§„ μ•κ³ , **μ‹¤μ§μ μΌλ΅ λ‡ κ°μ μ΄μ›ƒ λ°μ΄ν„° ν¬μΈνΈλ§ μ¤‘μ”ν•κ² μƒκ°ν• μ§€μ— λ”°λΌμ„ λ¶„μ‚°μ„ κ²°μ •**ν•λ” μ „λµμ„ μ·¨ν•κ³  μμµλ‹λ‹¤. κ·Έλ¦¬κ³  μ΄ λ¶„μ‚°μ„ μ •ν•κΈ° μ„ν•΄μ„ perplexityλΌλ” ν•μ΄νΌνλΌλ―Έν„°λ¥Ό λ„μ…ν•©λ‹λ‹¤. μ§κ΄€μ μΌλ΅ μƒκ° ν•΄λ³΄λ©΄, λ” λ§μ€ λ°μ΄ν„° ν¬μΈνΈλ¥Ό μ‹¤μ§μ μΈ μ΄μ›ƒμ΄λΌκ³  κ³ λ ¤ν• μλ΅ λ¶„μ‚°μ€ μ»¤μ§€κ³ , κ·Έ λ°λ€λ” λ°λ€κ°€ λ  κ²λ‹λ‹¤. μ—¬κΈ°μ„λ” μ΄ ν•μ΄νΌνλΌλ―Έν„°κ°€ μ™ ν•„μ”ν•μ§€λ§ μ§κ΄€μ μΌλ΅ μ΄ν•΄ν•κ³  λ„μ–΄κ°€κ³ , perplexityλ” μ•„λμ—μ„ λ” μμ„Έν μ„¤λ…ν•κ² μµλ‹λ‹¤.

<br>

## μ €μ°¨μ› ν™•λ¥  λ¶„ν¬ μ •μ - T λ¶„ν¬

![](/assets/img/post_img/student_t_pdf.png){:width="500"}_μμ λ„μ— λ”°λ¥Έ Student-t λ¶„ν¬_

μ €μ°¨μ›μ—μ„λ” T λ¶„ν¬μ— κΈ°λ°ν•μ—¬ λ‘ λ²΅ν„°κ°„μ κ±°λ¦¬λ¥Ό ν™•λ¥ μ κ°λ…μΌλ΅ ν‘ν„ν•λ” κ²ƒλ§ μ μ™Έν•λ©΄ μ„ μ ‘κ·Όλ²•κ³Ό κ±°μ μ μ‚¬ν•©λ‹λ‹¤. μ €μ°¨μ› κ³µκ°„μ— $$ y_1, \cdots, y_N (y_i \in \mathbb{R}^d)$$ λ°μ΄ν„° ν¬μΈνΈκ°€ μ΅΄μ¬ν•  λ•, μ•„λ μμ‹μΌλ΅ λ‘ λ°μ΄ν„° ν¬μΈνΈ $$y_i$$μ™€ $$y_j$$ μ‚¬μ΄μ κ±°λ¦¬(μ μ‚¬λ„)λ¥Ό ν™•λ¥  $$q_{ij}$$λ΅ λ³€ν™ν•©λ‹λ‹¤.



$$
q_{ij} = \frac{(1 + \| \mathbf{y}_i - \mathbf{y}_j \|^2)^{-1}}
{\sum_k \sum_{l \neq k} (1 + \| \mathbf{y}_k - \mathbf{y}_l \|^2)^{-1}}
$$

<br>

μ΄ μμ‹μ€ μμ λ„κ°€ 1μΈ student t-λ¶„ν¬μ™€ μ‚¬μ‹¤μƒ κ°™λ‹¤λ” κ²ƒμ„ μ• μ μμµλ‹λ‹¤. λ¨Όμ € student t-λ¶„ν¬μ PDFλ” λ‹¤μκ³Ό κ°™μµλ‹λ‹¤.



$$
f(t; \nu) = \frac{\Gamma\!\left(\tfrac{\nu+1}{2}\right)}{\sqrt{\pi \nu}\,\Gamma\!\left(\tfrac{\nu}{2}\right)}\left(1 + \frac{t^2}{\nu}\right)^{-\tfrac{\nu+1}{2}}
$$

<br>

μ΄λ• $$\nu = 1$$μ΄λΌκ³  ν•λ‹¤λ©΄, λ‹¤μκ³Ό κ°™μ΄ ν‘ν„ν•  μ μμµλ‹λ‹¤.

$$
f(t) = c\left(1 + t^2\right)^{-1}
$$


<br>

### μ €μ°¨μ› λ°μ΄ν„° ν¬μΈνΈ μ—…λ°μ΄νΈ - KL-Divergence & gradient descent

μ§€κΈκΉμ§€ λ…Όμλ¥Ό ν†µν•΄μ„ μ›λ κ³ μ°¨μ› κ³µκ°„μ—μ„μ λ°μ΄ν„° ν¬μΈνΈ κ°„μ κ±°λ¦¬λ¥Ό ν™•λ¥ λ΅ ν‘ν„ν•κ³ , λΉ„μ·ν• λ°©λ²•μΌλ΅ μ €μ°¨μ› κ³µκ°„μ—μ„μ λ°μ΄ν„° ν¬μΈνΈ κ°„μ κ±°λ¦¬λ¥Ό ν™•λ¥ λ΅ ν‘ν„ν•λ” λ°©λ²•μ„ μ‚΄ν΄ λ³΄μ•μµλ‹λ‹¤. κ·Έλ ‡λ‹¤λ©΄, μ €μ°¨μ› κ³µκ°„μ—μ„ κ²°μ •λ λ°μ΄ν„° ν¬μΈνΈκ°€ μ μ‚¬μƒλ κ²ƒμΈμ§€ μ–΄λ–»κ² κ²€μ¦ν•  μ μμ„κΉμ”? κ·Έλ¦¬κ³  λ°μ΄ν„° ν¬μΈνΈλ¥Ό λ” μ μ ν• μ„μΉλ΅ μ®κΈ°λ ¤λ©΄ μ–΄λ–»κ² ν•΄μ•Όν• κΉμ”? μ΄λ• λ”¥λ¬λ‹μ ν•™μµμ κΈ°λ°μ΄ λλ” μ λ…ν• KL-Divergenceμ™€ gradient descentκ°€ ν™μ©λ©λ‹λ‹¤.

<br>

λ¨Όμ €, KL-Divergenceλ” μ•„λμ μμ‹μ΄κ³ , μ΄ μμ‹μ€ ν™•λ¥  λ¶„ν¬ $$p_{ij}$$μ™€ $$q_{ij}$$μ μ°¨μ΄λ¥Ό μΈ΅μ •ν•κ² λ©λ‹λ‹¤.



$$
KL(P \parallel Q) = \sum_{i \neq j} p_{ij} \log \frac{p_{ij}}{q_{ij}}
$$

<br>

λ§μ§€λ§‰μΌλ΅ κ³„μ‚°λ KL-Divergenceλ¥Ό $$y_{i}$$μ— λ€ν•΄ λ―Έλ¶„ν•μ—¬ gradientλ¥Ό μ–»κ³ , μ΄λ¥Ό ν™μ©ν•μ—¬ $$y_i$$μ κ°’μ„ λ³€κ²½ν•λ” gradienct descentλ¥Ό μ μ©ν•κ² λ©λ‹λ‹¤. κ²°κ³Όμ μΌλ΅ λ”°λΌμ„ T-SNEλ” κ³ μ°¨μ› κ³µκ°„μ—μ„μ λ¶„ν¬λ¥Ό μ λ°μν•  μ μλ” μ €μ°¨μ› κ³µκ°„μ„ μ°Ύλ” μ°¨μ› μ¶•μ† μ•κ³ λ¦¬μ¦μ΄λΌκ³  λ³Ό μ μμµλ‹λ‹¤.

$$
y_i \leftarrow y_i - \eta \cfrac{\partial KL(P \parallel Q)}{\partial y_i}{}
$$

<br>

## Perplexity

perplexityλ€ $$x_i$$κ°€ **μ‹¤μ§μ μΌλ΅ νΉμ€ μ¤‘μ”ν•κ² κ³ λ ¤ν•λ”** μ΄μ›ƒ λ°μ΄ν„° ν¬μΈνΈ, **μ¦‰ μ ν¨ μ΄μ›ƒ μλ¥Ό μλ―Έ**ν•©λ‹λ‹¤. μ΄ κ°’μ΄ μ¤‘μ”ν• μ΄μ λ” μ΄μ— λ”°λΌ $$\sigma_i^2$$κ°€ κ²°μ •λκΈ° λ•λ¬Έμ…λ‹λ‹¤.

- perplexityκ°€ ν΄μλ΅ λ¶„μ‚° $$\sigma_i^2$$λ„ μ»¤μ§‘λ‹λ‹¤.
- perplexityκ°€ μ‘μ„μλ΅ λ¶„μ‚° $$\sigma_i^2$$λ„ μ‘μ•„μ§‘λ‹λ‹¤.



μ„μ—μ„ μ΄λ΅ μ μΌλ΅λ” λ¶„μ‚° κ³µμ‹μ— λ”°λΌ $$\sigma_i^2$$λ¥Ό κµ¬ν•  μλ” μμ§€λ§, T-SNEλ” κ·Έλ ‡κ² ν•μ§€ μ•λ”λ‹¤κ³  μ–ΈκΈ‰ ν–μµλ‹λ‹¤. T-SNEλ” κµ³μ΄ perplexityλΌλ” ν•μ΄νΌνλΌλ―Έν„°λ¥Ό ν†µν•΄ μ μ ν• λ¶„μ‚° $$\sigma_i^2$$μ„ κµ¬ν•©λ‹λ‹¤. λ„λ€μ²΄ μ΄μ κ°€ λ­κΉμ”? κ·Έ μ΄μ λ” λ°μ΄ν„°μ μ§€μ—­ λ°€λ„(local density)λ¥Ό κ³ λ ¤ν•΄μ„, **λ¨λ“  λ°μ΄ν„° ν¬μΈνΈκ°€ μ μ‚¬ν• μ ν¨ μ΄μ›ƒ μλ¥Ό κ°–λ„λ΅ κ· ν•μ„ λ§μ¶”κΈ° μ„ν•¨**μ…λ‹λ‹¤. 



μ•„λ κ·Έλν”„λ” perplexity=5μΌ λ•, **λ°€μ§‘ μμ—­μ— μλ” λΉ¨κ°• λ°μ΄ν„° ν¬μΈνΈ**μ™€ **ν¬μ† μμ—­μ— μλ” νλ‘ λ°μ΄ν„° ν¬μΈνΈ**μ— λ€ν•΄μ„ λ¶„μ‚° κ³µμ‹μ— λ”°λΌ **μ „μ—­ λ¶„μ‚°μ„ κµ¬ν–μ„ λ•μ κ°€μ°μ‹μ• λ¶„ν¬(μ μ„ )**μ™€ perplexityμ— λ”°λΌ **κµ­μ† λ¶„μ‚°μ„ κµ¬ν–μ„ λ•μ κ°€μ°μ‹μ• λ¶„ν¬(μ‹¤μ„ )**μ„ μ‹κ°ν™” ν–μµλ‹λ‹¤. 

![](/assets/img/post_img/tsne_perplexity_visualize.png){:width="750"}_perplexity=5μΌ λ•, μ§€μ—­ λ°€μ§‘λ„μ— λ”°λ¥Έ κ°€μ°μ‹μ• λ¶„ν¬_

- κµ­μ† λ¶„μ‚°(μ‹¤μ„ ): λ°μ΄ν„°μ λ°€μ§‘λ„λ¥Ό λ°μν•μ—¬ **λ³ΈμΈ μ£Όμ„μ μΌλ¶€λ§μ„ μ ν¨ μ΄μ›ƒμΌλ΅ κ³ λ ¤**ν•κ³  μμµλ‹λ‹¤.
- μ „μ—­ λ¶„μ‚°(μ μ„ ):λ°μ΄ν„°μ λ°€μ§‘λ„λ¥Ό λ°μν•μ§€ λ»ν•κ³ , **ν΄λ¬μ¤ν„° λ‚΄μ λ¨λ“  λ°μ΄ν„° ν¬μΈνΈλ¥Ό μ ν¨ μ΄μ›ƒμΌλ΅ κ³ λ ¤**ν•κ³  μμµλ‹λ‹¤.



**μ •λ¦¬ν•λ©΄, T-SNEλ” λ°μ΄ν„°μ μ§€μ—­ κµ¬μ΅°λ¥Ό λ³΄μ΅΄ν•κΈ° μ„ν•΄ μΌλ°μ μΈ λ¶„μ‚° κ³µμ‹μ— μν• μ „μ—­ λ¶„μ‚°μ„ μ‚¬μ©ν•μ§€ μ•κ³ , perplexityλΌλ” κ°’μ— κΈ°λ°ν• κµ­μ† λ¶„μ‚°μ„ ν™μ©ν•λ‹¤κ³  ν•  μ μμµλ‹λ‹¤.** μΌλ°μ μΌλ΅ perplexityλ” 5~50 μ‚¬μ΄μ κ°’μΌλ΅ μ„¤μ •ν•λ‹¤κ³  ν•©λ‹λ‹¤.



perplexityλ” shannon entropyμ— κΈ°λ°ν• λ‹¤μμ κ³µμ‹μ„ λ”°λ¦…λ‹λ‹¤.


$$
\text{Perplexity}(P_i) = 2^{-\sum p_{j \mid i} \log_2{p_{j \mid i}}}
$$

$$
\text{where} -\sum p_{j \mid i} \log_2{p_{j \mid i}} \text{ is Shannon entropy}
$$

<br>

λ§μ•½ $$\text{Perplexity}(P_i)=5$$λΌκ³  μ„¤μ • ν–μΌλ©΄, $$2^{-\sum p_{j \mid i} \log_2{p_{j \mid i}}}=5$$λ¥Ό λ§μ΅±ν•λ” λ¶„μ‚° $$\sigma_i^2$$μ„ μ°ΎμΌλ©΄ λ©λ‹λ‹¤.

<br>

# T-SNEμ λ‹¨μ κ³Ό λ³€ν• μ•κ³ λ¦¬μ¦λ“¤

T-SNEμ μµλ€ λ‹¨μ μ€ λ°μ΄ν„° ν¬μΈνΈκ°€ $$N$$κ° μΌλ•, ν• μ΄ν„°λ μ΄μ…μ—μ„ $$N^2$$κ°μ μμ„ λΉ„κµν•λ” μ—°μ‚°μ΄ ν•„μ”ν•λ‹¤λ” κ²ƒμ…λ‹λ‹¤. **μ¦‰, μ‹κ°„ λ³µμ΅λ„κ°€ $$O(N^2)$$**μ…λ‹λ‹¤. μ΄λ¥Ό κ·Ήλ³µν•κΈ° μ„ν•΄ λ‹¤μ–‘ν• λ³€ν• μ•κ³ λ¦¬μ¦λ“¤μ΄ μμΌλ‹ μ°Έκ³ ν•΄λ³΄μ„Έμ”.

- Barnes-Hut t-SNE: $$O(N \log N)$$
- Flt-SNE: $$O(N)$$

<br>

# Laurens van der Maaten(T-SNE μ €μ)μ FAQ

---

### How should I set the perplexity in t-SNE?

- The performance of t-SNE is fairly robust under different settings of the perplexity. 
- The most appropriate value depends on the density of your data. Loosely speaking, one could say that a larger / denser dataset requires a larger perplexity. 
- Typical values for the perplexity range between 5 and 50.



### What is perplexity anyway?

- In t-SNE, the perplexity may be viewed as a knob that sets the number of effective nearest neighbors. 
- It is comparable with the number of nearest neighbors k that is employed in many manifold learners.



### Every time I run t-SNE, I get a (slightly) different result?

- In contrast to, e.g., PCA, t-SNE has a non-convex objective function. 
- The objective function is minimized using a gradient descent optimization that is initiated randomly. As a result, it is possible that different runs give you different solutions. 
- Notice that it is perfectly fine to run t-SNE a number of times (with the same data and parameters), and to select the visualization with the lowest value of the objective function as your final visualization.

<br>

# μ°Έκ³ μλ£

- [t-distributed stochastic neighbor embedding](https://en.wikipedia.org/wiki/T-distributed_stochastic_neighbor_embedding#External_links)
- [Student's t-distribution](https://en.wikipedia.org/wiki/Student%27s_t-distribution)
- https://lvdmaaten.github.io/tsne/

